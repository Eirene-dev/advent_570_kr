var canvas = document.getElementById("mapCanvas");
var context = canvas.getContext("2d");

var winWidth = window.innerWidth;
var winHeight = window.innerHeight;
var mapWidth = 0; // Dimensions of full map image set after onload below.
var mapHeight = 0;

var viewWidth = canvas.width; // Dimensions of visible part of map
var viewHeight = canvas.height; //

var isTouch = "ontouchstart" in window || navigator.msMaxTouchPoints > 0;
//  if (!isTouch){
//		viewWidth = winWidth - 570 - 40;
//		context.canvas.width = viewWidth;
//  }

var isFireFox = navigator.userAgent.toLowerCase().indexOf("firefox") > -1;

var imageObj1 = new Image();
var imageObj2 = new Image();
var imageObj3 = new Image();
var imageObj4 = new Image();
var imageObj5 = new Image();
var imageObj6 = new Image();

var dragging = false;
var showmap = false;
var lastX = 0;
var lastY = 0;
var canX = 0;
var canY = 0;
var rightMaxX = 0;
var leftMaxX = 0;
var topMaxY = 0;
var botMaxY = 0;
var mapX = -350;
var mapY = -292;
var dragOffX = 0;
var dragOffY = 0;
var newDragOffX = 0;
var newDragOffY = 0;
var pinLoc = 1;
var ppinLoc = 0;
var showPirate;
var pirateLoc;
var chestLoc;

imageObj1.onload = function () {
  mapWidth = imageObj1.width;
  mapHeight = imageObj1.height;
  leftMaxX = viewWidth - mapWidth;
  botMaxY = viewHeight - mapHeight;

  showMapImages(0, 0, 0, 0);
};

if (version == 000) {
  imageObj1.src = "http://www.gobberwarts.com/map Adv000.jpeg";
  imageObj4.src = "http://www.gobberwarts.com/itms_Adv000.png";
} else if (version == 350) {
  imageObj1.src = "http://www.gobberwarts.com/map Adv350.jpeg";
  imageObj4.src = "http://www.gobberwarts.com/itms_Adv350.png";
} else if (version == 366) {
  imageObj1.src = "http://www.gobberwarts.com/map Adv366.jpeg";
  imageObj4.src = "http://www.gobberwarts.com/itms_Adv366.png";
}
if (version == 399) {
  imageObj1.src = "http://www.gobberwarts.com/map Adv399.jpeg";
  imageObj4.src = "http://www.gobberwarts.com/itms_Adv399.png";
} else if (version == 430) {
  imageObj1.src = "http://www.gobberwarts.com/map Adv430.jpeg";
  imageObj4.src = "http://www.gobberwarts.com/itms_Adv430.png";
} else if (version == 440) {
  imageObj1.src = "http://www.gobberwarts.com/map Adv440.jpeg";
  imageObj4.src = "http://www.gobberwarts.com/itms_Adv440.png";
} else if (version == 501) {
  imageObj1.src = "http://www.gobberwarts.com/map Adv501.jpeg";
  imageObj4.src = "http://www.gobberwarts.com/itms_Adv501.png";
} else if (version == 550) {
  imageObj1.src = "http://www.gobberwarts.com/map Adv550.jpeg";
  imageObj4.src = "http://www.gobberwarts.com/itms_Adv550.png";
}
if (version == 551) {
  imageObj1.src = "http://www.gobberwarts.com/map Adv551.jpeg";
  imageObj4.src = "http://www.gobberwarts.com/itms_Adv551.png";
}
if (version == 570) {
  imageObj1.src = "map Adv570.jpeg";
  imageObj4.src = "itms_Adv570.png";
}
if (version == 751) {
  imageObj1.src = "http://www.gobberwarts.com/map Adv751.jpeg";
  imageObj4.src = "http://www.gobberwarts.com/itms_Adv751.png";
}
imageObj2.src = "pin.png";
imageObj3.src = "pin shadow.png";
imageObj5.src = "pin_pirate.png";
imageObj6.src = "pin_dwarf.png";

if (!imageObj1.complete) {
  if (version == 000) imageObj1.src = "map Adv000.jpeg";
  else if (version == 350) imageObj1.src = "map Adv350.jpeg";
  else if (version == 366) imageObj1.src = "map Adv366.jpeg";
  else if (version == 399) imageObj1.src = "map Adv399.jpeg";
  else if (version == 430) imageObj1.src = "map Adv430.jpeg";
  else if (version == 440) imageObj1.src = "map Adv440.jpeg";
  else if (version == 501) imageObj1.src = "map Adv501.jpeg";
  else if (version == 550) imageObj1.src = "map Adv550.jpeg";
  else if (version == 551) imageObj1.src = "map Adv551.jpeg";
  else if (version == 570) imageObj1.src = "map Adv570.jpeg";
  else if (version == 751) imageObj1.src = "map Adv751.jpeg";
}
if (!imageObj2.complete) imageObj2.src = "pin.png";
if (!imageObj3.complete) imageObj3.src = "pin shadow.png";
if (!imageObj4.complete) {
  if (version == 000) imageObj4.src = "itms_Adv000.png";
  else if (version == 350) imageObj4.src = "itms_Adv350.png";
  else if (version == 366) imageObj4.src = "itms_Adv366.png";
  else if (version == 399) imageObj4.src = "itms_Adv399.png";
  else if (version == 430) imageObj4.src = "itms_Adv430.png";
  else if (version == 440) imageObj4.src = "itms_Adv440.png";
  else if (version == 501) imageObj4.src = "itms_Adv501.png";
  else if (version == 550) imageObj4.src = "itms_Adv550.png";
  else if (version == 551) imageObj4.src = "itms_Adv551.png";
  else if (version == 570) imageObj4.src = "itms_Adv570.png";
  else if (version == 751) imageObj4.src = "itms_Adv751.png";
}
if (!imageObj5.complete) imageObj5.src = "pin_pirate.png";
if (!imageObj6.complete) imageObj6.src = "pin_dwarf.png";

var itmSrcPosX = new Array();
var itmSrcPosY = new Array();
var itmSrcWd = 100;
var itmSrcHt = 24;
var jj = 0;
for (var ii = 0; ii <= 50; ii++) {
  jj++;
  (itmSrcPosX[jj] = 0), (itmSrcPosY[jj] = ii * 23);
  jj++;
  (itmSrcPosX[jj] = 144), (itmSrcPosY[jj] = ii * 23);
  jj++;
  (itmSrcPosX[jj] = 288), (itmSrcPosY[jj] = ii * 23);
  jj++;
  (itmSrcPosX[jj] = 432), (itmSrcPosY[jj] = ii * 23);
}

canvas.addEventListener("mousedown", mouseDown, false);
document.body.addEventListener("mouseup", mouseUp, false);
document.body.addEventListener("mousemove", mouseMove, false);
canvas.addEventListener("mouseover", mouseOver, false);
canvas.addEventListener("mouseout", mouseOut, false);
/*
canvas			.addEventListener("touchstart", mouseDown, false);
document.body	.addEventListener("touchend", mouseUp, false);
document.body	.addEventListener("touchmove", mouseMove, false);
*/

loadShowMap();
if (showmap) {
  document.getElementById("navbutton-M").setAttribute("class", "buttonMap");
} else {
  document.getElementById("navbutton-M").setAttribute("class", "buttonMapOff");
}

if (version == 000) {
  var PINXOFF = 355; // Offset position of pin image
  var PINYOFF = 387;
  var ITMXOFF = 350; // Offset position of item image
  var ITMYOFF = 352;
  //
  //    Adv000 Map Image (x,y) coordinates for a Pin at a given location number.
  //    ___________________________________________________________________________________________
  var mapXY = [
    // Loc: 0       1           2           3            4          5           6           7           8           9
    [0, 0],
    [1385, 577],
    [1335, 577],
    [1425, 577],
    [1449, 639],
    [1295, 587],
    [1300, 495],
    [1469, 710],
    [1512, 806],
    [1479, 855],
    //    10           11           12         13           14           15       16        17           18          19
    [1404, 855],
    [1353, 855],
    [1293, 859],
    [1234, 857],
    [1171, 854],
    [1068, 891],
    [0, 0],
    [1048, 891],
    [1068, 937],
    [1095, 674],
    //    20        21        22         23          24          25        26           27          28         29
    [0, 0],
    [0, 0],
    [0, 0],
    [344, 877],
    [393, 891],
    [345, 891],
    [0, 0],
    [1017, 891],
    [1153, 377],
    [1045, 731],
    //    30         31        32           33          34        35           36          37          38         39
    [960, 656],
    [0, 0],
    [0, 0],
    [1147, 280],
    [1237, 280],
    [984, 266],
    [967, 480],
    [1061, 483],
    [1082, 525],
    [900, 480],
    //    40          41         42          43          44          45          46          47          48         49
    [0, 0],
    [925, 891],
    [936, 932],
    [921, 940],
    [937, 944],
    [941, 983],
    [957, 940],
    [967, 952],
    [948, 951],
    [954, 963],
    //    50           51          52          53           4           55        56           57          58        59
    [928, 972],
    [969, 964],
    [952, 980],
    [919, 960],
    [987, 959],
    [974, 979],
    [992, 982],
    [1023, 989],
    [1006, 969],
    [0, 0],
    //    60            61        62           63           64        65           66          67          68          69
    [857, 892],
    [797, 886],
    [875, 651],
    [875, 610],
    [669, 542],
    [529, 656],
    [530, 747],
    [391, 877],
    [395, 732],
    [789, 658],
    //    70           71          72          73        74            75          76           77        78        79
    [700, 656],
    [505, 587],
    [245, 585],
    [242, 544],
    [912, 773],
    [705, 883],
    [708, 927],
    [651, 826],
    [601, 796],
    [0, 0],
    //    80        81        82      83        84        85        86        87        88        89
    [962, 974],
    [985, 989],
    [990, 988],
    [1023, 970],
    [1034, 972],
    [1044, 976],
    [1047, 980],
    [1040, 989],
    [258, 876],
    [0, 0],
    //    90        91        92      93        94        95        96        97        98        99
    [0, 0],
    [133, 625],
    [100, 787],
    [0, 0],
    [138, 739],
    [149, 703],
    [596, 747],
    [382, 621],
    [395, 561],
    [352, 502],
    //    100       101       102     103       104       105       106       107       108       109
    [444, 503],
    [487, 454],
    [721, 438],
    [651, 483],
    [581, 506],
    [546, 542],
    [738, 585],
    [791, 936],
    [873, 550],
    [941, 268],
    //    110       111       112     113       114       115       116       117       118       119
    [904, 259],
    [720, 749],
    [806, 941],
    [937, 213],
    [995, 989],
    [0, 0],
    [0, 0],
    [150, 455],
    [145, 523],
    [796, 754],
    //    120       121       122     123       124       125       126       127       128       129
    [796, 754],
    [796, 754],
    [198, 407],
    [284, 344],
    [387, 328],
    [425, 288],
    [423, 263],
    [478, 289],
    [397, 376],
    [442, 394],
    //    130       131       132     133       134       135       136       137       138       139
    [483, 396],
    [777, 945],
    [788, 961],
    [808, 941],
    [813, 956],
    [844, 948],
    [870, 953],
    [882, 970],
    [864, 967],
    [860, 979],
    //    140       141       142     143       144       145       146       147       148       149
    [819, 974],
    [521, 974],
    [521, 974],
    [587, 1030],
    [583, 967],
    [1304, 546],
    [1330, 533],
    [1355, 538],
    [1372, 514],
    [1403, 518],
    //    150       151       152     153       154       155       156       157       158       159
    [1420, 496],
    [1440, 505],
    [1436, 485],
    [1466, 491],
    [1472, 475],
    [1498, 488],
    [1305, 508],
    [1468, 443],
    [1457, 461],
    [1430, 452],
    //    160       161       162     163       164       165       166       167       168       169
    [1416, 467],
    [1395, 485],
    [1365, 478],
    [1370, 497],
    [1342, 491],
    [1336, 508],
    [1494, 456],
    [1295, 425],
    [937, 190],
    [937, 165],
    //    170       171       172     173       174       175       176       177       178       179
    [957, 139],
    [957, 110],
    [957, 84],
    [957, 60],
    [957, 38],
    [957, 38],
    [957, 38],
    [1041, 36],
    [0, 0],
    [0, 0],
    //    180       181       182     183       184       185       186       187       188       189
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //    190       191       192     193       194       195       196       197       198       199
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0]
  ];

  //
  //    Adv300 Item tag Image (x,y) offsets relative to Pin coordinates (above).
  //    Each location's offsets are specified to try to 'neatly' position an item tag at the location.
  //    ___________________________________________________________________________________________
  var itmsXY = [
    // Loc: 0       1       	2     		3       	4       	5         6         7       	8       	9
    [0, 0],
    [-20, -10],
    [-20, -10],
    [-25, 10],
    [-20, 0],
    [-30, -10],
    [0, 0],
    [-40, -30],
    [0, 20],
    [-20, 20],
    //    10        11        12      	13        14        15      16        17        18        19
    [-10, 20],
    [-10, 20],
    [-15, 16],
    [-15, 20],
    [-18, 20],
    [5, -15],
    [0, 0],
    [-10, -5],
    [-5, 10],
    [20, -20],
    //    20        21        22      	23        24        25        26        27        28        29
    [0, 0],
    [0, 0],
    [0, 0],
    [-32, -45],
    [-25, 30],
    [-40, 30],
    [0, 0],
    [-60, -20],
    [25, -15],
    [-30, 10],
    //    30        31        32      33        34        35        36        37        38        39
    [-30, 15],
    [0, 0],
    [0, 0],
    [15, 10],
    [0, 0],
    [0, 10],
    [-10, 15],
    [5, -35],
    [-15, 20],
    [-20, 15],
    //    40        41        42      	43        44        45        46        47        48        49
    [0, 0],
    [-15, -30],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //    50        51        52      	53        54        55        56        57        58        59
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    //    60        61        62      63        64        65        	66        67        	68        69
    [-2, 12],
    [5, -20],
    [-25, 15],
    [20, -15],
    [-35, 10],
    [-50, -27],
    [-52, 15],
    [-10, -40],
    [-90, -20],
    [-30, 20],
    //    70           71        72      	73           74        75        	76        77      78        79
    [-50, -10],
    [30, -20],
    [30, -25],
    [-15, -40],
    [-15, 15],
    [-80, -10],
    [-35, 5],
    [-20, 10],
    [0, 0],
    [0, 0],
    //    80        81        82      83        84        85        86        87        88        89
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    [0, 0],
    //    90        91        92      93        94        95        96        97        98        99
    [0, 0],
    [-25, 15],
    [55, 0],
    [0, 0],
    [5, -12],
    [50, -20],
    [-30, 12],
    [20, -35],
    [0, 10],
    [-25, 5],
    //    100       101       102     103       104       105       106       107       108       109
    [-20, 15],
    [30, -20],
    [35, -15],
    [25, -10],
    [-35, -42],
    [-20, 7],
    [-25, 10],
    [-4, -11],
    [40, -10],
    [-25, 0],
    //    110       111       112     113       114       115       116       117       118       119
    [-60, 10],
    [-20, 30],
    [-4, -11],
    [0, 0],
    [-5, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [30, -30],
    [-20, 15],
    //    120       121       122     123       124       125       126       127       128       129
    [-20, 15],
    [-20, 15],
    [10, -15],
    [-10, 15],
    [25, 10],
    [0, 5],
    [-55, -20],
    [50, -15],
    [-60, 10],
    [-30, 0],
    //    130       131       132     133       134       135       136       137       138       139
    [30, -20],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //    140       141       142     143       144       145       146       147       148       149
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [-4, -6],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //    150       151       152     153       154       155       156       157       158       159
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //    160       161       162     163       164       165       166       167       168       169
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-3, 5],
    [0, -11],
    [-4, -11],
    //    170       171       172     173       174       175       176       177       178       179
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [2, -11],
    [30, -25],
    [0, 0],
    [0, 0],
    //    180       181       182     183       184       185       186       187       188       189
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //    190       191       192     193       194       195       196       197       198       199
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0]
  ];

  //
  //    Adv000 Item display array - true means the item tag can be displayed on map.
  //    ___________________________________________________________________________________________
  //                      0      1      2      3      4      5      6      7      8      9
  var itmsDispl = [
    false,
    true,
    true,
    false,
    true,
    true,
    false,
    true,
    true,
    false,
    //                      10     11     12     13     14     15     16     17     18     19
    true,
    false,
    false,
    true,
    true,
    true,
    true,
    false,
    false,
    true,
    //                      20     21     22     23     24     25     26     27     28     29
    true,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    //                      30     31     32     33     34     35     36     37     38     39
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    false,
    false,
    true,
    //                      40     41     42     43     44     45     46     47     48     49
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                      50     51     52     53     54     55     56     57     58     59
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //                      60     61     62     63     64     65     66     67     68     69
    true,
    true,
    true,
    true,
    true,
    false,
    false,
    false,
    false,
    false,
    //                      70     71     72     73     74     75     76     77     78     79
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                      80     81     82     83     84     85     86     87     88     89
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false
  ];
} else if (version == 350 || version == 366) {
  var PINXOFF = 355; // Offset position of pin image
  var PINYOFF = 387;
  var ITMXOFF = 350; // Offset position of item image
  var ITMYOFF = 352;
  //
  //    Adv350 Map Image (x,y) coordinates for a Pin at a given location number.
  //    ___________________________________________________________________________________________
  var mapXY = [
    // Loc: 0       1           2           3            4          5           6           7           8           9
    [0, 0],
    [1385, 577],
    [1335, 577],
    [1425, 577],
    [1449, 639],
    [1295, 587],
    [1300, 495],
    [1469, 710],
    [1512, 806],
    [1479, 855],
    //    10        11        12      13        14        15        16        17        18        19
    [1404, 855],
    [1353, 855],
    [1293, 859],
    [1234, 857],
    [1171, 854],
    [1068, 891],
    [0, 0],
    [1048, 891],
    [1068, 937],
    [1095, 674],
    //    20        21        22      23        24        25        26        27        28        29
    [0, 0],
    [0, 0],
    [0, 0],
    [344, 877],
    [393, 891],
    [345, 891],
    [0, 0],
    [1017, 891],
    [1153, 377],
    [1045, 731],
    //    30        31        32      33        34        35        36        37        38        39
    [960, 656],
    [0, 0],
    [0, 0],
    [1147, 280],
    [1237, 280],
    [984, 266],
    [967, 480],
    [1061, 483],
    [1082, 525],
    [900, 480],
    //    40        41        42      43        44        45        46        47        48        49
    [0, 0],
    [925, 891],
    [936, 932],
    [921, 940],
    [937, 944],
    [941, 983],
    [957, 940],
    [967, 952],
    [948, 951],
    [954, 963],
    //    50        51        52      53        54        55        56        57        58        59
    [928, 972],
    [969, 964],
    [952, 980],
    [919, 960],
    [987, 959],
    [974, 979],
    [992, 982],
    [1023, 989],
    [1006, 969],
    [0, 0],
    //    60        61        62      63        64        65        66        67        68        69
    [857, 892],
    [797, 886],
    [875, 651],
    [875, 610],
    [669, 542],
    [529, 656],
    [530, 747],
    [391, 877],
    [395, 732],
    [789, 658],
    //    70           71          72          73          74          75          76          77        78        79
    [700, 656],
    [505, 587],
    [245, 585],
    [242, 544],
    [912, 773],
    [705, 883],
    [708, 927],
    [651, 826],
    [0, 0],
    [0, 0],
    //    80        81        82      83        84        85        86        87        88        89
    [962, 974],
    [985, 989],
    [990, 988],
    [1023, 970],
    [1034, 972],
    [1044, 976],
    [1047, 980],
    [1040, 989],
    [258, 876],
    [0, 0],
    //    90        91        92      93        94        95        96        97        98        99
    [0, 0],
    [133, 625],
    [100, 787],
    [0, 0],
    [138, 739],
    [149, 703],
    [596, 747],
    [382, 621],
    [395, 561],
    [352, 502],
    //    100       101       102     103       104       105       106       107       108       109
    [444, 503],
    [487, 454],
    [721, 438],
    [651, 483],
    [581, 506],
    [546, 542],
    [738, 585],
    [791, 936],
    [873, 550],
    [941, 268],
    //    110       111       112     113       114       115       116       117       118       119
    [904, 259],
    [720, 749],
    [806, 941],
    [937, 213],
    [995, 989],
    [0, 0],
    [0, 0],
    [150, 455],
    [145, 523],
    [796, 754],
    //    120       121       122     123       124       125       126       127       128       129
    [796, 754],
    [796, 754],
    [198, 407],
    [284, 344],
    [387, 328],
    [425, 288],
    [423, 263],
    [478, 289],
    [397, 376],
    [442, 394],
    //    130       131       132     133       134       135       136       137       138       139
    [483, 396],
    [777, 945],
    [788, 961],
    [808, 941],
    [813, 956],
    [844, 948],
    [870, 953],
    [882, 970],
    [864, 967],
    [860, 979],
    //    140       141            142          143       144         145          146         147         148       149
    [819, 974],
    [1320, 407],
    [1335, 347],
    [587, 1030],
    [583, 967],
    [1304, 546],
    [1330, 533],
    [1355, 538],
    [1372, 514],
    [1403, 518],
    //    150       151       152     153       154       155       156       157       158       159
    [1420, 496],
    [1440, 505],
    [1436, 485],
    [1466, 491],
    [1472, 475],
    [1498, 488],
    [1305, 508],
    [1468, 443],
    [1457, 461],
    [1430, 452],
    //    160       161       162     163       164       165       166       167       168       169
    [1416, 467],
    [1395, 485],
    [1365, 478],
    [1370, 497],
    [1342, 491],
    [1336, 508],
    [1494, 456],
    [1295, 425],
    [937, 190],
    [937, 165],
    //    170       171       172     173       174       175       176       177       178       179
    [957, 139],
    [957, 110],
    [957, 84],
    [957, 60],
    [957, 38],
    [957, 38],
    [957, 38],
    [1041, 36],
    [0, 0],
    [0, 0],
    //    180       181       182     183       184       185       186       187       188       189
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //    190       191       192     193       194       195       196       197       198       199
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0]
  ];

  //
  //    Adv350 Item tag Image (x,y) offsets relative to Pin coordinates (above).
  //    Each location's offsets are specified to try to 'neatly' position an item tag at the location.
  //    ___________________________________________________________________________________________
  var itmsXY = [
    // Loc: 0       1       	2     		3       	4       	5       	6       7       	8       	9
    [0, 0],
    [-20, -10],
    [-20, -10],
    [-25, 10],
    [-20, 0],
    [-30, -10],
    [-40, -30],
    [0, 0],
    [0, 20],
    [-20, 20],
    //    10        11        12      	13        14        15      16        17        18        19
    [-10, 20],
    [-10, 20],
    [-15, 16],
    [-15, 20],
    [-18, 20],
    [5, -15],
    [0, 0],
    [-10, -5],
    [-5, 10],
    [20, -20],
    //    20        21        22      	23        24        25        26        27        28        29
    [0, 0],
    [0, 0],
    [0, 0],
    [-32, -45],
    [-25, 30],
    [-40, 30],
    [0, 0],
    [-60, -30],
    [25, -15],
    [-30, 10],
    //    30        31        32      33        34        35        36        37        38        39
    [-30, 15],
    [0, 0],
    [0, 0],
    [15, 10],
    [0, 0],
    [0, 10],
    [-10, 15],
    [5, -35],
    [-15, 20],
    [-20, 15],
    //    40        41        42      	43        44        45        46        47        48        49
    [0, 0],
    [-15, -30],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //    50        51        52      	53        54        55        56        57        58        59
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    //    60        61        62      63        64        65        	66        67        	68        69
    [-2, 12],
    [5, -20],
    [-25, 15],
    [20, -15],
    [-35, 10],
    [-50, -27],
    [-52, 15],
    [-10, -40],
    [-90, -20],
    [-30, 20],
    //    70        71        72      	73        74        75        	76        77        78        79
    [-50, -10],
    [30, -20],
    [30, -25],
    [-15, -40],
    [-15, 15],
    [-80, -10],
    [-35, 5],
    [-20, 10],
    [0, 0],
    [0, 0],
    //    80        81        82      83        84        85        86        87        88        89
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    [0, 0],
    //    90        91        92      93        94        95        96        97        98        99
    [0, 0],
    [-25, 15],
    [55, 0],
    [0, 0],
    [5, -12],
    [50, -20],
    [-30, 12],
    [20, -35],
    [0, 10],
    [-25, 5],
    //    100       101       102     103       104       105       106       107       108       109
    [-20, 15],
    [30, -20],
    [35, -15],
    [25, -10],
    [-35, -42],
    [-20, 7],
    [-25, 10],
    [-4, -11],
    [40, -10],
    [-25, 0],
    //    110       111       112     113       114       115       116       117       118       119
    [-60, 10],
    [-20, 30],
    [-4, -11],
    [0, 0],
    [-5, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [30, -30],
    [-20, 15],
    //    120       121       122     123       124       125       126       127       128       129
    [-20, 15],
    [-20, 15],
    [10, -15],
    [-10, 15],
    [25, 10],
    [0, 5],
    [-55, -20],
    [50, -15],
    [-60, 10],
    [-30, 0],
    //    130       131       132     133       134       135       136       137       138       139
    [30, -20],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //    140       141       142     143       144       145       146       147       148       149
    [0, 0],
    [0, 0],
    [30, -15],
    [0, 0],
    [-4, -6],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //    150       151       152     153       154       155       156       157       158       159
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //    160       161       162     163       164       165       166       167       168       169
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-3, 5],
    [0, -11],
    [-4, -11],
    //    170       171       172     173       174       175       176       177       178       179
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [2, -11],
    [30, -25],
    [0, 0],
    [0, 0],
    //    180       181       182     183       184       185       186       187       188       189
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //    190       191       192     193       194       195       196       197       198       199
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0]
  ];

  //
  //    Adv350 Item display array - true means the item tag can be displayed on map.
  //    ___________________________________________________________________________________________
  //                      0      1      2      3      4      5      6      7      8      9
  var itmsDispl = [
    false,
    true,
    true,
    false,
    true,
    true,
    true,
    false,
    true,
    false,
    //                      10     11     12     13     14     15     16     17     18     19
    true,
    false,
    false,
    false,
    true,
    true,
    true,
    false,
    false,
    true,
    //                      20     21     22     23     24     25     26     27     28     29
    true,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    //                      30     31     32     33     34     35     36     37     38     39
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    false,
    false,
    true,
    //                      40     41     42     43     44     45     46     47     48     49
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                      50     51     52     53     54     55     56     57     58     59
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //                      60     61     62     63     64     65     66     67     68     69
    true,
    true,
    true,
    true,
    true,
    true,
    false,
    false,
    false,
    false,
    //                      70     71     72     73     74     75     76     77     78     79
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                      80     81     82     83     84     85     86     87     88     89
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false
  ];
} else if (version == 399) {
  var PINXOFF = 355; // Offset position of pin image
  var PINYOFF = 387;
  var ITMXOFF = 350; // Offset position of item image
  var ITMYOFF = 352;
  //
  //    Adv350 Map Image (x,y) coordinates for a Pin at a given location number.
  //    ___________________________________________________________________________________________
  var mapXY = [
    // Loc: 0       1           2           3            4          5           6           7           8           9
    [0, 0],
    [1385, 577],
    [1335, 577],
    [1425, 577],
    [1449, 639],
    [1295, 587],
    [1300, 495],
    [1469, 710],
    [1512, 806],
    [1479, 855],
    //    10        11        12      13        14        15        16        17        18        19
    [1404, 855],
    [1353, 855],
    [1293, 859],
    [1234, 857],
    [1171, 854],
    [1068, 891],
    [0, 0],
    [1048, 891],
    [1068, 937],
    [1095, 674],
    //    20        21        22      23        24        25        26        27        28        29
    [0, 0],
    [0, 0],
    [0, 0],
    [344, 877],
    [393, 891],
    [345, 891],
    [0, 0],
    [1017, 891],
    [1153, 377],
    [1045, 731],
    //    30        31        32      33        34        35        36        37        38        39
    [960, 656],
    [0, 0],
    [0, 0],
    [1147, 280],
    [1237, 280],
    [984, 266],
    [967, 480],
    [1061, 483],
    [1082, 525],
    [900, 480],
    //    40        41        42      43        44        45        46        47        48        49
    [0, 0],
    [925, 891],
    [936, 932],
    [921, 940],
    [937, 944],
    [941, 983],
    [957, 940],
    [967, 952],
    [948, 951],
    [954, 963],
    //    50        51        52      53        54        55        56        57        58        59
    [928, 972],
    [969, 964],
    [952, 980],
    [919, 960],
    [987, 959],
    [974, 979],
    [992, 982],
    [1023, 989],
    [1006, 969],
    [0, 0],
    //    60        61        62      63        64        65        66        67        68        69
    [857, 892],
    [797, 886],
    [875, 651],
    [875, 610],
    [669, 542],
    [529, 656],
    [530, 747],
    [391, 877],
    [395, 732],
    [789, 658],
    //    70           71          72          73          74          75          76          77        78        79
    [700, 656],
    [505, 587],
    [245, 585],
    [242, 544],
    [912, 773],
    [705, 883],
    [708, 927],
    [651, 826],
    [0, 0],
    [0, 0],
    //    80        81        82      83        84        85        86        87        88        89
    [962, 974],
    [985, 989],
    [990, 988],
    [1023, 970],
    [1034, 972],
    [1044, 976],
    [1047, 980],
    [1040, 989],
    [258, 876],
    [0, 0],
    //    90        91        92      93        94        95        96        97        98        99
    [0, 0],
    [133, 625],
    [100, 787],
    [0, 0],
    [138, 739],
    [149, 703],
    [596, 747],
    [382, 621],
    [395, 561],
    [352, 502],
    //    100       101       102     103       104       105       106       107       108       109
    [444, 503],
    [487, 454],
    [721, 438],
    [651, 483],
    [581, 506],
    [546, 542],
    [738, 585],
    [791, 936],
    [873, 550],
    [941, 268],
    //    110       111       112     113       114       115       116       117       118       119
    [904, 259],
    [720, 749],
    [806, 941],
    [937, 213],
    [995, 989],
    [0, 0],
    [0, 0],
    [150, 455],
    [145, 523],
    [796, 754],
    //    120       121       122     123       124       125       126       127       128       129
    [796, 754],
    [796, 754],
    [198, 407],
    [284, 344],
    [387, 328],
    [425, 288],
    [423, 263],
    [478, 289],
    [397, 376],
    [442, 394],
    //    130       131       132     133       134       135       136       137       138       139
    [483, 396],
    [777, 945],
    [788, 961],
    [808, 941],
    [813, 956],
    [844, 948],
    [870, 953],
    [882, 970],
    [864, 967],
    [860, 979],
    //    140       141            142          143       144         145          146         147         148       149
    [819, 974],
    [1320, 407],
    [1335, 347],
    [587, 1030],
    [583, 967],
    [1304, 546],
    [1330, 533],
    [1355, 538],
    [1372, 514],
    [1403, 518],
    //    150       151       152     153       154       155       156       157       158       159
    [1420, 496],
    [1440, 505],
    [1436, 485],
    [1466, 491],
    [1472, 475],
    [1498, 488],
    [1305, 508],
    [1468, 443],
    [1457, 461],
    [1430, 452],
    //    160       161       162     163       164       165       166       167       168       169
    [1416, 467],
    [1395, 485],
    [1365, 478],
    [1370, 497],
    [1342, 491],
    [1336, 508],
    [1494, 456],
    [1295, 425],
    [937, 190],
    [937, 165],
    //    170       171       172     173       174       175       176       177       178       179
    [957, 139],
    [957, 110],
    [957, 84],
    [957, 60],
    [957, 38],
    [957, 38],
    [957, 38],
    [1041, 36],
    [0, 0],
    [0, 0],
    //    180       181       182     183       184       185       186       187       188       189
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //    190       191       192     193       194       195       196       197       198       199
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0]
  ];

  //
  //    Adv399 Item tag Image (x,y) offsets relative to Pin coordinates (above).
  //    Each location's offsets are specified to try to 'neatly' position an item tag at the location.
  //    ___________________________________________________________________________________________
  var itmsXY = [
    // Loc: 0       1       	2     		3       	4       	5       	6       7       	8       	9
    [0, 0],
    [-20, -10],
    [-20, -10],
    [-25, 10],
    [-20, 0],
    [-30, -10],
    [-40, -30],
    [0, 0],
    [0, 20],
    [-20, 20],
    //    10        11        12      	13        14        15      16        17        18        19
    [-10, 20],
    [-10, 20],
    [-15, 16],
    [-15, 20],
    [-18, 20],
    [5, -15],
    [0, 0],
    [-10, -5],
    [-5, 10],
    [20, -20],
    //    20        21        22      	23        24        25        26        27        28        29
    [0, 0],
    [0, 0],
    [0, 0],
    [-32, -45],
    [-25, 30],
    [-40, 30],
    [0, 0],
    [-60, -30],
    [25, -15],
    [-30, 10],
    //    30        31        32      33        34        35        36        37        38        39
    [-30, 15],
    [0, 0],
    [0, 0],
    [15, 10],
    [0, 0],
    [0, 10],
    [-10, 15],
    [5, -35],
    [-15, 20],
    [-20, 15],
    //    40        41        42      	43        44        45        46        47        48        49
    [0, 0],
    [-15, -30],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //    50        51        52      	53        54        55        56        57        58        59
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    //    60        61        62      63        64        65        	66        67        	68        69
    [-2, 12],
    [5, -20],
    [-25, 15],
    [20, -15],
    [-35, 10],
    [-50, -27],
    [-52, 15],
    [-10, -40],
    [-90, -20],
    [-30, 20],
    //    70        71        72      	73        74        75        	76        77        78        79
    [-50, -10],
    [30, -20],
    [30, -25],
    [-15, -40],
    [-15, 15],
    [-80, -10],
    [-35, 5],
    [-20, 10],
    [0, 0],
    [0, 0],
    //    80        81        82      83        84        85        86        87        88        89
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    [0, 0],
    //    90        91        92      93        94        95        96        97        98        99
    [0, 0],
    [-25, 15],
    [55, 0],
    [0, 0],
    [5, -12],
    [50, -20],
    [-30, 12],
    [20, -35],
    [0, 10],
    [-25, 5],
    //    100       101       102     103       104       105       106       107       108       109
    [-20, 15],
    [30, -20],
    [35, -15],
    [25, -10],
    [-35, -42],
    [-20, 7],
    [-25, 10],
    [-4, -11],
    [40, -10],
    [-25, 0],
    //    110       111       112     113       114       115       116       117       118       119
    [-60, 10],
    [-20, 30],
    [-4, -11],
    [0, 0],
    [-5, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [30, -30],
    [-20, 15],
    //    120       121       122     123       124       125       126       127       128       129
    [-20, 15],
    [-20, 15],
    [10, -15],
    [-10, 15],
    [25, 10],
    [0, 5],
    [-55, -20],
    [50, -15],
    [-60, 10],
    [-30, 0],
    //    130       131       132     133       134       135       136       137       138       139
    [30, -20],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //    140       141       142     143       144       145       146       147       148       149
    [0, 0],
    [0, 0],
    [30, -15],
    [0, 0],
    [-4, -6],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //    150       151       152     153       154       155       156       157       158       159
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //    160       161       162     163       164       165       166       167       168       169
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-3, 5],
    [0, -11],
    [-4, -11],
    //    170       171       172     173       174       175       176       177       178       179
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [2, -11],
    [30, -25],
    [0, 0],
    [0, 0],
    //    180       181       182     183       184       185       186       187       188       189
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //    190       191       192     193       194       195       196       197       198       199
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0]
  ];

  //
  //    Adv399 Item display array - true means the item tag can be displayed on map.
  //    ___________________________________________________________________________________________
  //                      0      1      2      3      4      5      6      7      8      9
  var itmsDispl = [
    false,
    true,
    true,
    false,
    true,
    true,
    true,
    false,
    true,
    false,
    //                      10     11     12     13     14     15     16     17     18     19
    true,
    false,
    false,
    false,
    true,
    true,
    true,
    false,
    false,
    true,
    //                      20     21     22     23     24     25     26     27     28     29
    true,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    //                      30     31     32     33     34     35     36     37     38     39
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    false,
    false,
    true,
    //                      40     41     42     43     44     45     46     47     48     49
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                      50     51     52     53     54     55     56     57     58     59
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //                      60     61     62     63     64     65     66     67     68     69
    true,
    true,
    true,
    true,
    true,
    true,
    false,
    false,
    false,
    false,
    //                      70     71     72     73     74     75     76     77     78     79
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                      80     81     82     83     84     85     86     87     88     89
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false
  ];
} else if (version == 430) {
  var PINXOFF = 355; // Offset position of pin image (less is right)
  var PINYOFF = 333; //   							(less is down)
  var ITMXOFF = PINXOFF - 5; // Offset position of item image
  var ITMYOFF = PINYOFF - 40;
  //
  //		Adv430 Map Image (x,y) coordinates for a Pin at a given location number.
  //		___________________________________________________________________________________________
  var mapXY = [
    // Loc: 0    		1    		2			3    		4    		5    		6    		7    		8    		9
    [0, 0],
    [1385, 577],
    [1335, 577],
    [1425, 577],
    [1449, 639],
    [1295, 587],
    [1300, 495],
    [1469, 710],
    [1512, 806],
    [1479, 855],
    // 		10    		11    		12			13    		14    		15    		16    		17    		18    		19
    [1404, 855],
    [1353, 855],
    [1293, 859],
    [1234, 857],
    [1171, 854],
    [1068, 891],
    [0, 0],
    [1048, 891],
    [1068, 937],
    [1095, 674],
    //		20    		21    		22			23    		24    		25    		26    		27    		28    		29
    [0, 0],
    [0, 0],
    [0, 0],
    [344, 877],
    [393, 891],
    [345, 891],
    [0, 0],
    [1017, 891],
    [1153, 377],
    [1045, 731],
    //		30    		31    		32			33    		34    		35    		36    		37    		38    		39
    [960, 656],
    [0, 0],
    [0, 0],
    [1147, 280],
    [1237, 280],
    [984, 266],
    [967, 480],
    [1061, 483],
    [1082, 525],
    [900, 480],
    //		40    		41    		42			43    		44    		45    		46    		47    		48    		49
    [0, 0],
    [925, 891],
    [936, 932],
    [921, 940],
    [937, 944],
    [941, 983],
    [957, 940],
    [967, 952],
    [948, 951],
    [954, 963],
    //		50    		51    		52			53    		54    		55    		56    		57    		58    		59
    [928, 972],
    [969, 964],
    [952, 980],
    [919, 960],
    [987, 959],
    [974, 979],
    [992, 982],
    [1023, 989],
    [1006, 969],
    [0, 0],
    //		60    		61    		62			63    		64    		65    		66    		67    		68    		69
    [857, 892],
    [797, 886],
    [875, 651],
    [875, 610],
    [669, 542],
    [529, 656],
    [530, 747],
    [391, 877],
    [395, 732],
    [789, 658],
    //		70    		71    		72			73    		74    		75    		76    		77    		78    		79
    [700, 656],
    [505, 587],
    [245, 585],
    [242, 544],
    [912, 773],
    [705, 883],
    [708, 927],
    [651, 826],
    [0, 0],
    [0, 0],
    //		80    		81    		82			83    		84    		85    		86    		87    		88    		89
    [962, 974],
    [985, 989],
    [990, 988],
    [1023, 970],
    [1034, 972],
    [1044, 976],
    [1047, 980],
    [1040, 989],
    [258, 876],
    [0, 0],
    //		90    		91    		92			93    		94    		95    		96    		97    		98    		99
    [0, 0],
    [133, 625],
    [100, 787],
    [0, 0],
    [138, 739],
    [149, 703],
    [596, 747],
    [382, 621],
    [395, 561],
    [352, 502],
    //		100    		101    		102			103    		104    		105    		106    		107    		108    		109
    [444, 503],
    [487, 454],
    [721, 438],
    [651, 483],
    [581, 506],
    [546, 542],
    [738, 585],
    [791, 936],
    [873, 550],
    [941, 268],
    //		110    		111    		112			113    		114    		115    		116    		117    		118    		119
    [904, 259],
    [720, 749],
    [806, 941],
    [937, 213],
    [995, 989],
    [0, 0],
    [0, 0],
    [150, 455],
    [145, 523],
    [796, 754],
    //		120    		121    		122			123    		124    		125    		126    		127    		128    		129
    [796, 754],
    [796, 754],
    [198, 407],
    [284, 344],
    [387, 328],
    [425, 288],
    [423, 263],
    [478, 289],
    [397, 376],
    [442, 394],
    //		130    		131    		132			133    		134    		135    		136    		137    		138    		139
    [483, 396],
    [777, 945],
    [788, 961],
    [808, 941],
    [813, 956],
    [844, 948],
    [870, 953],
    [882, 970],
    [864, 967],
    [860, 979],
    //		140    		141    		142			143    		144    		145    		146    		147    		148    		149
    [819, 974],
    [521, 974],
    [521, 974],
    [587, 1030],
    [583, 967],
    [1304, 546],
    [1330, 533],
    [1355, 538],
    [1372, 514],
    [1403, 518],
    //		150    		151    		152			153    		154    		155    		156    		157    		158    		159
    [1420, 496],
    [1440, 505],
    [1436, 485],
    [1466, 491],
    [1472, 475],
    [1498, 488],
    [1305, 508],
    [1468, 443],
    [1457, 461],
    [1430, 452],
    //		160    		161    		162			163    		164    		165    		166    		167    		168    		169
    [1416, 467],
    [1395, 485],
    [1365, 478],
    [1370, 497],
    [1342, 491],
    [1336, 508],
    [1494, 456],
    [1295, 425],
    [937, 190],
    [937, 165],
    //		170    		171    		172			173    		174    		175    		176    		177    		178    		179
    [957, 139],
    [957, 110],
    [957, 84],
    [957, 60],
    [957, 38],
    [957, 38],
    [957, 38],
    [1041, 36],
    [0, 0],
    [0, 0],
    //		180    		181    		182			183    		184    		185    		186    		187    		188    		189
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //		190    		191    		192			193    		194    		195    		196    		197    		198    		199
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0]
  ];

  //
  //		Adv430 Item tag Image (x,y) offsets from Pin coordinates (above).
  //		Each location's offsets are specified to try to 'neatly' position an item tag at the location.
  //		___________________________________________________________________________________________
  var itmsXY = [
    // Loc: 0    		1    		2			3    		4    		5    		6    		7    		8    		9
    [0, 0],
    [-20, -10],
    [-20, -10],
    [-25, 10],
    [-20, 0],
    [-30, -10],
    [-40, -30],
    [0, 0],
    [0, 20],
    [-20, 20],
    // 		10    		11    		12			13    		14    		15    		16    		17    		18    		19
    [-10, 20],
    [-10, 20],
    [-15, 16],
    [-15, 20],
    [-18, 20],
    [5, -15],
    [0, 0],
    [-10, -5],
    [-5, 10],
    [20, -20],
    //		20    		21    		22			23    		24    		25    		26    		27    		28    		29
    [0, 0],
    [0, 0],
    [0, 0],
    [-32, -45],
    [-25, 30],
    [-40, 30],
    [0, 0],
    [-60, -30],
    [25, -15],
    [-30, 10],
    //		30    		31    		32			33    		34    		35    		36    		37    		38    		39
    [-30, 15],
    [0, 0],
    [0, 0],
    [15, 10],
    [0, 0],
    [0, 10],
    [-10, 15],
    [5, -35],
    [-15, 20],
    [-20, 15],
    //		40    		41    		42			43    		44    		45    		46    		47    		48    		49
    [0, 0],
    [-15, -30],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //		50    		51    		52			53    		54    		55    		56    		57    		58    		59
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    //		60    		61    		62			63    		64    		65    		66    		67    		68    		69
    [-2, 12],
    [5, -20],
    [-25, 15],
    [20, -15],
    [-35, 10],
    [-50, -27],
    [-52, 15],
    [-10, -40],
    [-90, -20],
    [-30, 20],
    //		70    		71    		72			73    		74    		75    		76    		77    		78    		79
    [-50, -10],
    [30, -20],
    [30, -25],
    [-15, -40],
    [-15, 15],
    [-80, -10],
    [-35, 5],
    [-20, 10],
    [0, 0],
    [0, 0],
    //		80    		81    		82			83    		84    		85    		86    		87    		88    		89
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    [0, 0],
    //		90    		91    		92			93    		94    		95    		96    		97    		98    		99
    [0, 0],
    [-25, 15],
    [55, 0],
    [0, 0],
    [5, -12],
    [50, -20],
    [-30, 12],
    [20, -35],
    [0, 10],
    [-25, 5],
    //		100    		101    		102			103    		104    		105    		106    		107    		108    		109
    [-20, 15],
    [30, -20],
    [35, -15],
    [25, -10],
    [-35, -42],
    [-20, 7],
    [-25, 10],
    [-4, -11],
    [40, -10],
    [-25, 0],
    //		110    		111    		112			113    		114    		115    		116    		117    		118    		119
    [-60, 10],
    [-20, 30],
    [-4, -11],
    [0, 0],
    [-5, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [30, -30],
    [-20, 15],
    //		120    		121    		122			123    		124    		125    		126    		127    		128    		129
    [-20, 15],
    [-20, 15],
    [10, -15],
    [-10, 15],
    [25, 10],
    [0, 5],
    [-55, -20],
    [50, -15],
    [-60, 10],
    [-30, 0],
    //		130    		131    		132			133    		134    		135    		136    		137    		138    		139
    [30, -20],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //		140    		141    		142			143    		144    		145    		146    		147    		148    		149
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [-4, -6],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //		150    		151    		152			153    		154    		155    		156    		157    		158    		159
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //		160    		161    		162			163    		164    		165    		166    		167    		168    		169
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-3, 5],
    [0, -11],
    [-4, -11],
    //		170    		171    		172			173    		174    		175    		176    		177    		178    		179
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [2, -11],
    [30, -25],
    [0, 0],
    [0, 0],
    //		180    		181    		182			183    		184    		185    		186    		187    		188    		189
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //		190    		191    		192			193    		194    		195    		196    		197    		198    		199
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0]
  ];

  //
  //		Adv430 Item display array - true means the item tag can be displayed on map.
  //		___________________________________________________________________________________________
  //                              	0      1      2      3      4      5      6      7      8      9
  var itmsDispl = [
    false,
    true,
    true,
    false,
    true,
    true,
    true,
    false,
    true,
    false,
    //          						10     11     12     13     14     15     16     17     18     19
    true,
    false,
    false,
    false,
    true,
    true,
    true,
    false,
    false,
    true,
    //          						20     21     22     23     24     25     26     27     28     29
    true,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    //          						30     31     32     33     34     35     36     37     38     39
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    false,
    false,
    true,
    //          						40     41     42     43     44     45     46     47     48     49
    false,
    false,
    true,
    false,
    false,
    false,
    true,
    false,
    false,
    false,
    //          						50     51     52     53     54     55     56     57     58     59
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //          						60     61     62     63     64     65     66     67     68     69
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //          						70     71     72     73     74     75     76     77     78     79
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //          						80     81     82     83     84     85     86     87     88     89
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false
  ];
} else if (version == 440) {
  var PINXOFF = 355; // Offset position of pin image (less is right)
  var PINYOFF = 333; //   							(less is down)
  var ITMXOFF = PINXOFF - 5; // Offset position of item image
  var ITMYOFF = PINYOFF - 40;
  //
  //		Adv440 Map Image (x,y) coordinates for a Pin at a given location number.
  //		___________________________________________________________________________________________
  var mapXY = [
    // Loc: 0    		1    		2			3    		4    		5    		6    		7    		8    		9
    [0, 0],
    [1385, 577],
    [1335, 577],
    [1425, 577],
    [1449, 639],
    [1295, 587],
    [1300, 495],
    [1469, 710],
    [1512, 806],
    [1479, 855],
    // 		10    		11    		12			13    		14    		15    		16    		17    		18    		19
    [1404, 855],
    [1353, 855],
    [1293, 859],
    [1234, 857],
    [1171, 854],
    [1068, 891],
    [0, 0],
    [1048, 891],
    [1068, 937],
    [1095, 674],
    //		20    		21    		22			23    		24    		25    		26    		27    		28    		29
    [0, 0],
    [0, 0],
    [0, 0],
    [272, 784],
    [322, 798],
    [273, 798],
    [0, 0],
    [1017, 891],
    [1153, 377],
    [1045, 731],
    //		30    		31    		32			33    		34    		35    		36    		37    		38    		39
    [960, 656],
    [0, 0],
    [0, 0],
    [1147, 280],
    [1237, 280],
    [984, 266],
    [967, 480],
    [1061, 483],
    [1082, 525],
    [900, 480],
    //		40    		41    		42			43    		44    		45    		46    		47    		48    		49
    [0, 0],
    [925, 891],
    [936, 932],
    [921, 940],
    [937, 944],
    [941, 983],
    [957, 940],
    [967, 952],
    [948, 951],
    [954, 963],
    //		50    		51    		52			53    		54    		55    		56    		57    		58    		59
    [928, 972],
    [969, 964],
    [952, 980],
    [919, 960],
    [987, 959],
    [974, 979],
    [992, 982],
    [1023, 989],
    [1006, 969],
    [0, 0],
    //		60    		61    		62			63    		64    		65    		66    		67    		68    		69
    [857, 892],
    [797, 886],
    [875, 651],
    [875, 610],
    [669, 542],
    [529, 656],
    [530, 747],
    [320, 784],
    [221, 735],
    [789, 658],
    //		70    		71    		72			73    		74    		75    		76    		77    		78    		79
    [700, 656],
    [505, 587],
    [245, 585],
    [242, 544],
    [912, 773],
    [705, 883],
    [708, 927],
    [651, 826],
    [0, 0],
    [0, 0],
    //		80    		81    		82			83    		84    		85    		86    		87    		88    		89
    [962, 974],
    [985, 989],
    [990, 988],
    [1023, 970],
    [1034, 972],
    [1044, 976],
    [1047, 980],
    [1040, 989],
    [183, 869],
    [0, 0],
    //		90    		91    		92			93    		94    		95    		96    		97    		98    		99
    [0, 0],
    [133, 625],
    [100, 787],
    [0, 0],
    [138, 739],
    [149, 703],
    [357, 857],
    [382, 621],
    [395, 561],
    [352, 502],
    //		100    		101    		102			103    		104    		105    		106    		107    		108    		109
    [444, 503],
    [487, 454],
    [721, 438],
    [651, 483],
    [581, 506],
    [546, 542],
    [769, 555],
    [791, 936],
    [873, 550],
    [941, 268],
    //		110    		111    		112			113    		114    		115    		116    		117    		118    		119
    [904, 259],
    [720, 749],
    [806, 941],
    [937, 213],
    [995, 989],
    [0, 0],
    [0, 0],
    [150, 455],
    [145, 523],
    [796, 754],
    //		120    		121    		122			123    		124    		125    		126    		127    		128    		129
    [796, 754],
    [796, 754],
    [198, 407],
    [284, 344],
    [387, 328],
    [425, 288],
    [423, 263],
    [478, 289],
    [397, 376],
    [442, 394],
    //		130    		131    		132			133    		134    		135    		136    		137    		138    		139
    [483, 396],
    [777, 945],
    [788, 961],
    [808, 941],
    [813, 956],
    [844, 948],
    [870, 953],
    [882, 970],
    [864, 967],
    [860, 979],
    //		140    		141    		142			143    		144    		145    		146    		147    		148    		149
    [819, 974],
    [576, 923],
    [649, 925],
    [344, 945],
    [548, 852],
    [345, 910],
    [344, 981],
    [363, 981],
    [385, 981],
    [344, 1000],
    //		150    		151    		152			153    		154    		155    		156    		157    		158    		159
    [363, 1000],
    [385, 1000],
    [708, 969],
    [411, 893],
    [707, 1006],
    [937, 213],
    [937, 213],
    [1468, 443],
    [1457, 461],
    [1430, 452],
    //		160    		161    		162			163    		164    		165    		166    		167    		168    		169
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [257, 906],
    [1432, 977],
    [1295, 425],
    [582, 990],
    [479, 950],
    //		170    		171    		172			173    		174    		175    		176    		177    		178    		179
    [483, 906],
    [483, 875],
    [483, 842],
    [412, 952],
    [839, 398],
    [841, 360],
    [761, 399],
    [694, 401],
    [766, 358],
    [0, 0],
    //		180    		181    		182			183    		184    		185    		186    		187    		188    		189
    [625, 88],
    [628, 123],
    [630, 175],
    [633, 241],
    [629, 297],
    [629, 347],
    [568, 227],
    [0, 0],
    [0, 0],
    [323, 733],
    //		190    		191    		192			193    		194    		195    		196    		197    		198    		199
    [388, 726],
    [560, 179],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [893, 825],
    [721, 1041],
    [0, 0]
  ];

  //
  //		Adv440 Item tag Image (x,y) offsets from Pin coordinates (above).
  //		Each location's offsets are specified to try to 'neatly' position an item tag at the location.
  //		___________________________________________________________________________________________
  var itmsXY = [
    // Loc: 0    		1    		2			3    		4    		5    		6    		7    		8    		9
    [0, 0],
    [-20, -10],
    [-20, -10],
    [-25, 10],
    [-20, 0],
    [-30, -10],
    [-40, -30],
    [0, 0],
    [0, 20],
    [-20, 20],
    // 		10    		11    		12			13    		14    		15    		16    		17    		18    		19
    [-10, 20],
    [-10, 20],
    [-15, 16],
    [-15, 20],
    [-18, 20],
    [5, -15],
    [0, 0],
    [-10, -5],
    [-5, 10],
    [20, -20],
    //		20    		21    		22			23    		24    		25    		26    		27    		28    		29
    [0, 0],
    [0, 0],
    [0, 0],
    [-32, -45],
    [-25, 30],
    [-40, 30],
    [0, 0],
    [-60, -30],
    [25, -15],
    [-30, 20],
    //		30    		31    		32			33    		34    		35    		36    		37    		38    		39
    [-30, 15],
    [0, 0],
    [0, 0],
    [15, 10],
    [0, 0],
    [0, 10],
    [-10, 15],
    [5, -35],
    [-15, 20],
    [-20, 15],
    //		40    		41    		42			43    		44    		45    		46    		47    		48    		49
    [0, 0],
    [-15, -30],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //		50    		51    		52			53    		54    		55    		56    		57    		58    		59
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    //		60    		61    		62			63    		64    		65    		66    		67    		68    		69
    [-2, 12],
    [5, -20],
    [-25, 15],
    [20, -15],
    [-35, 10],
    [-50, -27],
    [-52, 15],
    [-10, -40],
    [-90, -20],
    [-30, 20],
    //		70    		71    		72			73    		74    		75    		76    		77    		78    		79
    [-50, -10],
    [30, -20],
    [30, -25],
    [-15, -40],
    [-15, 15],
    [-80, -10],
    [-35, 5],
    [-20, 10],
    [0, 0],
    [0, 0],
    //		80    		81    		82			83    		84    		85    		86    		87    		88    		89
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    [0, 0],
    //		90    		91    		92			93    		94    		95    		96    		97    		98    		99
    [0, 0],
    [-25, 15],
    [55, 0],
    [0, 0],
    [5, -12],
    [45, -40],
    [0, -33],
    [20, -35],
    [0, 10],
    [-25, 5],
    //		100    		101    		102			103    		104    		105    		106    		107    		108    		109
    [-20, 15],
    [30, -20],
    [35, -15],
    [25, -10],
    [-35, -42],
    [-20, 7],
    [-45, 5],
    [-4, -11],
    [40, -10],
    [-25, 0],
    //		110    		111    		112			113    		114    		115    		116    		117    		118    		119
    [-60, 10],
    [-20, 30],
    [-4, -11],
    [0, 0],
    [-5, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [30, -30],
    [-20, 15],
    //		120    		121    		122			123    		124    		125    		126    		127    		128    		129
    [-20, 15],
    [-20, 15],
    [10, -15],
    [-10, 15],
    [25, 10],
    [0, 5],
    [-55, -20],
    [-25, 5],
    [-60, 10],
    [-30, 0],
    //		130    		131    		132			133    		134    		135    		136    		137    		138    		139
    [30, -20],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //		140    		141    		142			143    		144    		145    		146    		147    		148    		149
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [-14, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [15, -24],
    [-4, -11],
    //		150    		151    		152			153    		154    		155    		156    		157    		158    		159
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [21, -16],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //		160    		161    		162			163    		164    		165    		166    		167    		168    		169
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [-4, -11],
    [-4, -11],
    [-3, 5],
    [0, -11],
    [-4, -11],
    //		170    		171    		172			173    		174    		175    		176    		177    		178    		179
    [-4, -11],
    [-4, -11],
    [-18, -44],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [2, -11],
    [-15, 5],
    [0, 0],
    [0, 0],
    //		180    		181    		182			183    		184    		185    		186    		187    		188    		189
    [45, -20],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //		190    		191    		192			193    		194    		195    		196    		197    		198    		199
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0]
  ];

  //
  //		Adv440 Item display array - true means the item tag can be displayed on map.
  //		___________________________________________________________________________________________
  //                              	0      1      2      3      4      5      6      7      8      9
  var itmsDispl = [
    false,
    true,
    true,
    false,
    true,
    true,
    true,
    false,
    true,
    false,
    //          						10     11     12     13     14     15     16     17     18     19
    true,
    false,
    false,
    false,
    true,
    true,
    true,
    false,
    false,
    true,
    //          						20     21     22     23     24     25     26     27     28     29
    true,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    //          						30     31     32     33     34     35     36     37     38     39
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    false,
    false,
    true,
    //          						40     41     42     43     44     45     46     47     48     49
    false,
    false,
    true,
    false,
    true,
    true,
    true,
    false,
    false,
    false,
    //          						50     51     52     53     54     55     56     57     58     59
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //          						60     61     62     63     64     65     66     67     68     69
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //          						70     71     72     73     74     75     76     77     78     79
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //          						80     81     82     83     84     85     86     87     88     89
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false
  ];
} else if (version == 501) {
  var PINXOFF = 363; // Offset position of pin image (less is right)
  var PINYOFF = 96; //   							(less is down)
  var ITMXOFF = PINXOFF - 5; // Offset position of item image
  var ITMYOFF = PINYOFF - 40;
  //
  //		Adv501 Map Image (x,y) coordinates for a Pin at a given location number.
  //		___________________________________________________________________________________________
  var mapXY = [
    // Loc: 0    		1    		2			3    		4    		5    		6    		7    		8    		9
    [0, 0],
    [1385, 577],
    [1335, 577],
    [1425, 577],
    [1449, 639],
    [1309, 502],
    [1300, 495],
    [1469, 710],
    [1512, 806],
    [1479, 855],
    // 		10    		11    		12			13    		14    		15    		16    		17    		18    		19
    [1404, 855],
    [1353, 855],
    [1293, 859],
    [1234, 857],
    [1171, 854],
    [1068, 891],
    [0, 0],
    [1048, 891],
    [1068, 937],
    [1095, 674],
    //		20    		21    		22			23    		24    		25    		26    		27    		28    		29
    [0, 0],
    [0, 0],
    [0, 0],
    [344, 877],
    [393, 891],
    [345, 891],
    [0, 0],
    [1017, 891],
    [1153, 377],
    [1045, 731],
    //		30    		31    		32			33    		34    		35    		36    		37    		38    		39
    [960, 656],
    [0, 0],
    [0, 0],
    [1147, 280],
    [1237, 280],
    [984, 266],
    [967, 480],
    [1061, 483],
    [1082, 525],
    [900, 480],
    //		40    		41    		42			43    		44    		45    		46    		47    		48    		49
    [0, 0],
    [925, 891],
    [936, 932],
    [921, 940],
    [937, 944],
    [941, 983],
    [957, 940],
    [967, 952],
    [948, 951],
    [954, 963],
    //		50    		51    		52			53    		54    		55    		56    		57    		58    		59
    [928, 972],
    [969, 964],
    [952, 980],
    [919, 960],
    [987, 959],
    [974, 979],
    [992, 982],
    [1023, 989],
    [1006, 969],
    [0, 0],
    //		60    		61    		62			63    		64    		65    		66    		67    		68    		69
    [857, 892],
    [797, 886],
    [875, 651],
    [875, 610],
    [669, 542],
    [529, 656],
    [530, 747],
    [391, 877],
    [395, 732],
    [789, 658],
    //		70    		71    		72			73    		74    		75    		76    		77    		78    		79
    [700, 656],
    [505, 587],
    [245, 585],
    [247, 524],
    [912, 773],
    [705, 851],
    [711, 890],
    [651, 826],
    [0, 0],
    [0, 0],
    //		80    		81    		82			83    		84    		85    		86    		87    		88    		89
    [962, 974],
    [985, 989],
    [990, 988],
    [1023, 970],
    [1034, 972],
    [1044, 976],
    [1047, 980],
    [1040, 989],
    [258, 876],
    [0, 0],
    //		90    		91    		92			93    		94    		95    		96    		97    		98    		99
    [0, 0],
    [133, 625],
    [100, 787],
    [0, 0],
    [138, 739],
    [149, 703],
    [596, 747],
    [382, 621],
    [395, 561],
    [352, 502],
    //		100    		101    		102			103    		104    		105    		106    		107    		108    		109
    [444, 503],
    [487, 454],
    [721, 438],
    [651, 483],
    [581, 506],
    [546, 542],
    [738, 585],
    [729, 991],
    [873, 550],
    [941, 268],
    //		110    		111    		112			113    		114    		115    		116    		117    		118    		119
    [904, 259],
    [720, 749],
    [675, 975],
    [937, 213],
    [995, 989],
    [0, 0],
    [0, 0],
    [150, 455],
    [145, 523],
    [796, 754],
    //		120    		121    		122			123    		124    		125    		126    		127    		128    		129
    [796, 754],
    [796, 754],
    [198, 407],
    [284, 344],
    [387, 328],
    [425, 288],
    [423, 263],
    [478, 289],
    [397, 376],
    [442, 394],
    //		130    		131    		132			133    		134    		135    		136    		137    		138    		139
    [483, 396],
    [694, 969],
    [682, 968],
    [681, 986],
    [641967],
    [641, 985],
    [689, 991],
    [723, 1001],
    [742, 999],
    [709, 981],
    //		140    		141    		142			143    		144    		145    		146    		147    		148    		149
    [714, 976],
    [241, 684],
    [301, 683],
    [1210, 617],
    [1248, 618],
    [1304, 546],
    [1433, 467],
    [1429, 320],
    [1433, 182],
    [1433, 148],
    //		150    		151    		152			153    		154    		155    		156    		157    		158    		159
    [1402, 147],
    [1457, 148],
    [1436, 107],
    [1172, 189],
    [1176, 118],
    [1065, 108],
    [1305, 508],
    [1041, 4],
    [1300, 15],
    [1301, -38],
    //		160    		161    		162			163    		164    		165    		166    		167    		168    		169
    [1305, 57],
    [1395, 485],
    [1365, 478],
    [1370, 497],
    [1342, 491],
    [1336, 508],
    [52, 27],
    [1375, 51],
    [185, 34],
    [183, -28],
    //		170    		171    		172			173    		174    		175    		176    		177    		178    		179
    [257, 55],
    [337, 95],
    [879, 951],
    [957, 60],
    [851, 1018],
    [781, 995],
    [957, 38],
    [708, 935],
    [0, 0],
    [258, -22],
    //		180    		181    		182			183    		184    		185    		186    		187    		188    		189
    [418, 98],
    [0, 0],
    [358, 207],
    [484, 199],
    [592, 173],
    [485, 241],
    [589, 235],
    [547, 137],
    [636, 200],
    [0, 0],
    //		190    		191    		192			193    		194    		195    		196    		197    		198    		199
    [593, 357],
    [827, 935],
    [100, 98],
    [251, 115],
    [775, -204],
    [774 - 204],
    [728, 431],
    [190, 110],
    [326, -34],
    [0, 0],
    //		200    		201    		202			203    		204    		205    		206    		207    		208    		209
    [380, 25],
    [457, 24],
    [545, 22],
    [404, -32],
    [488, -32],
    [554, -27],
    [692, 25],
    [692, -21],
    [692, -92],
    [635, -98],
    //		210    		211    		212			213    		214    		215    		216    		217    		218    		219
    [685, -157],
    [741, -150],
    [0, 0],
    [689, 100],
    [84, -61],
    [148, -107],
    [232, -85],
    [316, -93],
    [399, 96],
    [554, -93],
    //		220    		221    		222			223    		224    		225    		226    		227    		228    		229
    [597, -95],
    [516, -94],
    [557, -119],
    [558, -188],
    [694, -200],
    [1423, 698],
    [0, 0],
    [1107, 0],
    [1188, 12],
    [1239, 12],
    //		230    		231    		232			233    		234    		235    		236    		237    		238    		239
    [421, -151],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [590, 313],
    [0, 0],
    [0, 0],
    [1462, 560],
    [1289, 792],
    //		240    		241    		242			243    		244    		245    		246    		247    		248    		249
    [1351, 789],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0]
  ];

  //
  //		Adv501 Item tag Image (x,y) offsets from Pin coordinates (above). Less is left, up.
  //		Each location's offsets are specified to try to 'neatly' position an item tag at the location.
  //		___________________________________________________________________________________________
  var itmsXY = [
    // Loc: 0    		1    		2			3    		4    		5    		6    		7    		8    		9
    [0, 0],
    [-20, -10],
    [-20, -10],
    [-25, 10],
    [-20, 0],
    [-30, -10],
    [-40, -30],
    [0, 0],
    [0, 20],
    [-20, 20],
    // 		10    		11    		12			13    		14    		15    		16    		17    		18    		19
    [-10, 20],
    [-10, 20],
    [-15, 16],
    [-15, 20],
    [-18, 20],
    [5, -15],
    [0, 0],
    [-10, -5],
    [-5, 10],
    [20, -20],
    //		20    		21    		22			23    		24    		25    		26    		27    		28    		29
    [0, 0],
    [0, 0],
    [0, 0],
    [-32, -45],
    [-25, 30],
    [-40, 30],
    [0, 0],
    [-60, -30],
    [20, -15],
    [-30, 10],
    //		30    		31    		32			33    		34    		35    		36    		37    		38    		39
    [-30, 15],
    [0, 0],
    [0, 0],
    [15, 10],
    [0, 0],
    [0, 10],
    [-10, 15],
    [5, -35],
    [-15, 20],
    [-20, 15],
    //		40    		41    		42			43    		44    		45    		46    		47    		48    		49
    [0, 0],
    [-15, -30],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //		50    		51    		52			53    		54    		55    		56    		57    		58    		59
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    //		60    		61    		62			63    		64    		65    		66    		67    		68    		69
    [-2, 12],
    [5, -20],
    [-25, 15],
    [20, -15],
    [-35, 10],
    [-50, -27],
    [-52, 15],
    [-10, -40],
    [-90, -20],
    [-30, 20],
    //		70    		71    		72			73    		74    		75    		76    		77    		78    		79
    [-50, -10],
    [30, -20],
    [30, -25],
    [-15, -40],
    [-15, 15],
    [-80, -10],
    [-35, 5],
    [-20, 10],
    [0, 0],
    [0, 0],
    //		80    		81    		82			83    		84    		85    		86    		87    		88    		89
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    [0, 0],
    //		90    		91    		92			93    		94    		95    		96    		97    		98    		99
    [0, 0],
    [-25, 15],
    [55, 0],
    [0, 0],
    [5, -12],
    [50, -20],
    [-30, 12],
    [20, -35],
    [0, 10],
    [-25, 5],
    //		100    		101    		102			103    		104    		105    		106    		107    		108    		109
    [-20, 15],
    [25, -25],
    [35, -15],
    [25, -10],
    [-35, -42],
    [-20, 7],
    [-25, 10],
    [-4, -11],
    [40, -10],
    [-25, 0],
    //		110    		111    		112			113    		114    		115    		116    		117    		118    		119
    [-60, 10],
    [-20, 30],
    [-4, -11],
    [0, 0],
    [-5, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [30, -30],
    [-20, 15],
    //		120    		121    		122			123    		124    		125    		126    		127    		128    		129
    [-20, 15],
    [-20, 15],
    [10, -15],
    [-10, 15],
    [25, 10],
    [0, 5],
    [-55, -20],
    [-25, 5],
    [-60, 10],
    [-30, 0],
    //		130    		131    		132			133    		134    		135    		136    		137    		138    		139
    [30, -20],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //		140    		141    		142			143    		144    		145    		146    		147    		148    		149
    [0, 0],
    [-25, 20],
    [0, 0],
    [0, 0],
    [-20, 20],
    [-4, -11],
    [-4, -11],
    [-75, 20],
    [-4, -11],
    [-4, -11],
    //		150    		151    		152			153    		154    		155    		156    		157    		158    		159
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //		160    		161    		162			163    		164    		165    		166    		167    		168    		169
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-3, 5],
    [0, -31],
    [-18, -25],
    //		170    		171    		172			173    		174    		175    		176    		177    		178    		179
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [20, -11],
    [-4, -11],
    [2, -11],
    [30, -25],
    [0, 0],
    [0, 0],
    //		180    		181    		182			183    		184    		185    		186    		187    		188    		189
    [0, 15],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //		190    		191    		192			193    		194    		195    		196    		197    		198    		199
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [-10, 0],
    [0, 0],
    //		200    		201    		202			203    		204    		205    		206    		207    		208    		209
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [-35, 13],
    [25, -15],
    [0, 0],
    [0, 0],
    [0, 0],
    [-10, 20],
    //		210    		211    		212			213    		214    		215    		216    		217    		218    		219
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //		220    		221    		222			223    		224    		225    		226    		227    		228    		229
    [-15, 25],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //		230    		231    		232			233    		234    		235    		236    		237    		238    		239
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [20, 20],
    [0, 0],
    //		240    		241    		242			243    		244    		245    		246    		247    		248    		249
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0]
  ];

  //
  //		Adv501 Item display array - true means the item tag can be displayed on map.
  //		___________________________________________________________________________________________
  //                              	0      1      2      3      4      5      6      7      8      9
  var itmsDispl = [
    false,
    true,
    true,
    false,
    true,
    true,
    true,
    false,
    true,
    false,
    //          						10     11     12     13     14     15     16     17     18     19
    true,
    false,
    false,
    false,
    true,
    true,
    true,
    false,
    false,
    true,
    //          						20     21     22     23     24     25     26     27     28     29
    true,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    //          						30     31     32     33     34     35     36     37     38     39
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    false,
    false,
    true,
    //          						40     41     42     43     44     45     46     47     48     49
    true,
    false,
    false,
    false,
    false,
    false,
    true,
    true,
    false,
    true,
    //          						50     51     52     53     54     55     56     57     58     59
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //          						60     61     62     63     64     65     66     67     68     69
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //          						70     71     72     73     74     75     76     77     78     79
    true,
    true,
    true,
    true,
    false,
    false,
    false,
    false,
    false,
    false,
    //          						80     81     82     83     84     85     86     87     88     89
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //	          						90     91     92     93     94     95     96     97     98     99
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                              	100    101    102    103    104    105    106    107    108    109
    false,
    true,
    true,
    false,
    false,
    false,
    true,
    false,
    true,
    false,
    //	                              	110    111    112    113    114    115    116    117    118    119
    false,
    false,
    false,
    true,
    true,
    false,
    false,
    false,
    true,
    true,
    //	                              	120    121    122    123    124    125    126    127    128    129
    true,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                                  130    131    132    133    134    145    136    137    138    139
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                                  140    141    142    143    144    145    146    147    148    149
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                                  150    151    152    153    154    155    156    157    158    159
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                                  160    161    162    163    164    165    166    167    168    169
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false
  ];
} else if (version == 550) {
  var PINXOFF = 363; // Offset position of pin image (less is right)
  var PINYOFF = 96; //   							(less is down)
  var ITMXOFF = PINXOFF - 5; // Offset position of item image
  var ITMYOFF = PINYOFF - 40;

  //
  //		Adv550 Map Image (x,y) coordinates for a Pin at a given location number.
  //		___________________________________________________________________________________________
  var mapXY = [
    // Loc: 0    		1    		2			3    		4    		5    		6    		7    		8    		9
    [1400, 350],
    [1368, 274],
    [1446, 331],
    [1447, 387],
    [1421, 248],
    [1365, 303],
    [1477, 462],
    [1524, 567],
    [1489, 613],
    [1416, 613],
    // 		10    		11    		12			13    		14    		15    		16    		17    		18    		19
    [1363, 610],
    [1302, 614],
    [1243, 610],
    [1174, 609],
    [1075, 652],
    [1057, 649],
    [1028, 649],
    [1060, 693],
    [1116, 430],
    [352, 634],
    //		20    		21    		22			23    		24    		25    		26    		27    		28    		29
    [401, 634],
    [402, 650],
    [355, 650],
    [1163, 138],
    [1053, 487],
    [964, 416],
    [1164, 38],
    [1241, 43],
    [1008, 27],
    [890, 14],
    //		30    		31    		32			33    		34    		35    		36    		37    		38    		39
    [973, 240],
    [1058, 238],
    [1096, 284],
    [906, 240],
    [940, 648],
    [951, 702],
    [959, 696],
    [953, 711],
    [965, 701],
    [972, 701],
    //		40    		41    		42			43    		44    		45    		46    		47    		48    		49
    [957, 706],
    [949, 717],
    [939, 717],
    [952, 719],
    [952, 728],
    [968, 732],
    [959, 733],
    [971, 737],
    [971, 720],
    [974, 721],
    //		50    		51    		52			53    		54    		55    		56    		57    		58    		59
    [1013, 738],
    [1011, 743],
    [868, 649],
    [806, 648],
    [884, 411],
    [886, 367],
    [675, 300],
    [505, 412],
    [515, 505],
    [401, 492],
    //		60    		61    		62			63    		64    		65    		66    		67    		68    		69
    [796, 419],
    [709, 412],
    [511, 341],
    [253, 345],
    [253, 303],
    [932, 532],
    [712, 640],
    [718, 682],
    [660, 580],
    [562, 581],
    //		70    		71    		72			73    		74    		75    		76    		77    		78    		79
    [938, 705],
    [945, 709],
    [951, 707],
    [1013, 724],
    [1055, 735],
    [999, 722],
    [968, 737],
    [0, 0],
    [239, 634],
    [134, 385],
    //		80    		81    		82			83    		84    		85    		86    		87    		88    		89
    [106, 564],
    [140, 520],
    [152, 470],
    [603, 508],
    [388, 379],
    [402, 319],
    [362, 259],
    [450, 262],
    [498, 212],
    [665, 197],
    //		90    		91    		92			93    		94    		95    		96    		97    		98    		99
    [660, 247],
    [586, 265],
    [559, 299],
    [748, 344],
    [792, 692],
    [883, 311],
    [951, 28],
    [729, 507],
    [352, 502],
    [950, -29],
    //		100    		101    		102			103    		104    		105    		106    		107    		108    		109
    [953, -77],
    [955, -107],
    [1054, -149],
    [1467, 435],
    [1440, -23],
    [738, 585],
    [1035, 723],
    [161, 211],
    [206, 167],
    [153, 283],
    //		110    		111    		112			113    		114    		115    		116    		117    		118    		119
    [810, 511],
    [812, 513],
    [302, 104],
    [397, 87],
    [434, 47],
    [432, 24],
    [289, -12],
    [289, -26],
    [74, -58],
    [72, -80],
    //		120    		121    		122			123    		124    		125    		126    		127    		128    		129
    [94, -81],
    [164, -55],
    [188, -114],
    [205, -181],
    [76, -189],
    [62, -129],
    [290, -79],
    [292, -91],
    [305, -138],
    [414, -107],
    //		130    		131    		132			133    		134    		135    		136    		137    		138    		139
    [482, -84],
    [600, -69],
    [702, -134],
    [775, -135],
    [633, -156],
    [634, -150],
    [621, -144],
    [618, -149],
    [620, -144],
    [611, -144],
    //		140    		141    		142			143    		144    		145    		146    		147    		148    		149
    [605, -148],
    [600, -158],
    [599, -171],
    [588, -152],
    [572, -161],
    [561, -154],
    [573, -156],
    [582, -151],
    [592, -157],
    [604, -162],
    //		150    		151    		152			153    		154    		155    		156    		157    		158    		159
    [612, -147],
    [619, -143],
    [619, -138],
    [586, -168],
    [599, -171],
    [626, 97],
    [624, 35],
    [698, -15],
    [557, -14],
    [486, 45],
    //		160    		161    		162			163    		164    		165    		166    		167    		168    		169
    [404, 136],
    [450, 133],
    [487, 135],
    [794, 715],
    [816, 721],
    [812, 712],
    [813, 706],
    [828, 714],
    [836, 722],
    [858, 727],
    //		170    		171    		172			173    		174    		175    		176    		177    		178    		179
    [867, 727],
    [872, 716],
    [851, 708],
    [1148, 672],
    [1212, 375],
    [1159, 488],
    [307, -182],
    [1160, 497],
    [1251, 543],
    [1251, 515],
    //		180    		181    		182			183    		184    		185    		186    		187    		188    		189
    [1255, 490],
    [1019, 380],
    [1059, 344],
    [972, 354],
    [238, 564],
    [245, 522],
    [312, 483],
    [502, 636],
    [488, 667],
    [517, 715],
    //		190    		191    		192			193    		194    		195    		196    		197    		198    		199
    [676, 727],
    [681, 750],
    [688, 732],
    [672, 751],
    [673, 738],
    [663, 749],
    [660, 729],
    [657, 717],
    [646, 722],
    [652, 731],
    //		200    		201    		202			203    		204    		205    		206    		207    		208    		209
    [646, 753],
    [647, 757],
    [644, 738],
    [639, 724],
    [630, 715],
    [618, 723],
    [618, 735],
    [619, 751],
    [614, 754],
    [610, 722],
    //		210    		211    		212			213    		214    		215    		216    		217    		218    		219
    [614, 738],
    [603, 717],
    [592, 721],
    [599, 733],
    [602, 753],
    [592, 750],
    [593, 731],
    [593, 722],
    [592, 717],
    [583, 721],
    //		220    		221    		222			223    		224    		225    		226    		227    		228    		229
    [586, 733],
    [587, 748],
    [572, 739],
    [573, 730],
    [577, 723],
    [577, 721],
    [572, 732],
    [529, 666],
    [545, 632],
    [587, 641],
    //		230    		231    		232			233    		234    		235    		236    		237    		238    		239
    [609, 672],
    [646, 679],
    [747, 201],
    [780, 200],
    [786, 188],
    [820, 200],
    [819, 216],
    [744, 140],
    [825, 93],
    [977, 124],
    //		240    		241    		242			243    		244    		245    		246    		247    		248    		249
    [951, 99],
    [905, 97],
    [0, 0],
    [896, 95],
    [879, 93],
    [878, 73],
    [855, 93],
    [806, 97],
    [0, 0]
  ];

  //
  //		Adv550 Item tag Image (x,y) offsets from Pin coordinates (above). Less is left, up.
  //		Each location's offsets are specified to try to 'neatly' position an item tag at the location.
  //		___________________________________________________________________________________________
  var itmsXY = [
    // Loc: 0    		1    		2			3    		4    		5    		6    		7    		8    		9
    [-20, 0],
    [-20, -10],
    [-65, 20],
    [-20, 0],
    [-30, -10],
    [-40, -30],
    [-10, 0],
    [0, 20],
    [-20, 20],
    [-10, 20],
    // 		10    		11    		12			13    		14    		15    		16    		17    		18    		19
    [-10, 20],
    [-15, 16],
    [-15, 22],
    [-18, 20],
    [-5, -15],
    [0, 0],
    [-40, -20],
    [0, 15],
    [-20, -30],
    [0, 0],
    //		20    		21    		22			23    		24    		25    		26    		27    		28    		29
    [0, 0],
    [0, 0],
    [-32, -45],
    [18, -15],
    [-40, 20],
    [-20, 18],
    [-60, -30],
    [20, -15],
    [-30, 10],
    [-30, 15],
    //		30    		31    		32			33    		34    		35    		36    		37    		38    		39
    [0, 0],
    [0, 0],
    [15, 10],
    [0, 0],
    [0, 10],
    [-10, 15],
    [5, -35],
    [-15, 20],
    [-20, 15],
    [0, 0],
    //		40    		41    		42			43    		44    		45    		46    		47    		48    		49
    [-15, -30],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //		50    		51    		52			53    		54    		55    		56    		57    		58    		59
    [-4, -11],
    [-4, -11],
    [-14, 0],
    [-4, -20],
    [-20, 15],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    [-2, 12],
    //		60    		61    		62			63    		64    		65    		66    		67    		68    		69
    [5, -20],
    [-25, 15],
    [20, -15],
    [-35, 10],
    [-50, -27],
    [-52, 15],
    [-10, -40],
    [-90, -20],
    [-30, 20],
    [-50, -10],
    //		70    		71    		72			73    		74    		75    		76    		77    		78    		79
    [30, -20],
    [30, -25],
    [-15, -40],
    [-15, 15],
    [-80, -10],
    [-35, 5],
    [-20, 10],
    [0, 0],
    [0, 0],
    [-4, -11],
    //		80    		81    		82			83    		84    		85    		86    		87    		88    		89
    [-15, 13],
    [-4, -11],
    [24, -11],
    [-15, 13],
    [23, -23],
    [28, -15],
    [-20, 10],
    [-12, 17],
    [23, -30],
    [-10, 0],
    //		90    		91    		92			93    		94    		95    		96    		97    		98    		99
    [20, -10],
    [-10, 0],
    [-15, 15],
    [-25, 10],
    [-10, 0],
    [-30, 20],
    [20, -35],
    [0, 10],
    [-25, 5],
    [-20, 15],
    //		100    		101    		102			103    		104    		105    		106    		107    		108    		109
    [-10, -3],
    [35, -15],
    [-20, 5],
    [-35, -42],
    [1441, -25],
    [-25, 10],
    [10, -11],
    [40, -10],
    [-25, 0],
    [-60, 10],
    //		110    		111    		112			113    		114    		115    		116    		117    		118    		119
    [-20, 20],
    [-4, -11],
    [0, 0],
    [-5, 0],
    [0, 0],
    [0, 0],
    [-60, -10],
    [40, -10],
    [-20, 15],
    [-40, -15],
    //		120    		121    		122			123    		124    		125    		126    		127    		128    		129
    [-20, 15],
    [25, -20],
    [-10, 15],
    [5, 10],
    [10, 15],
    [-55, -20],
    [-25, 5],
    [-60, 10],
    [-30, 0],
    [30, -20],
    //		130    		131    		132			133    		134    		135    		136    		137    		138    		139
    [-4, -11],
    [38, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, 11],
    //		140    		141    		142			143    		144    		145    		146    		147    		148    		149
    [-4, 11],
    [-4, 11],
    [-4, 11],
    [-4, 11],
    [-4, -11],
    [-4, -11],
    [-75, 20],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //		150    		151    		152			153    		154    		155    		156    		157    		158    		159
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-14, -21],
    [-4, -11],
    [-4, -11],
    [-10, 18],
    [18, -18],
    [-15, 16],
    //		160    		161    		162			163    		164    		165    		166    		167    		168    		169
    [-4, -11],
    [-4, -11],
    [25, -15],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    //		170    		171    		172			173    		174    		175    		176    		177    		178    		179
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [28, -11],
    [6, -31],
    [2, -11],
    [70, -45],
    [-20, 5],
    [13, -10],
    [0, 15],
    //		180    		181    		182			183    		184    		185    		186    		187    		188    		189
    [20, -10],
    [0, 0],
    [-20, 12],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [-40, -10],
    [-20, -10],
    [-60, -20],
    //		190    		191    		192			193    		194    		195    		196    		197    		198    		199
    [0, 0],
    [0, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    //		200    		201    		202			203    		204    		205    		206    		207    		208    		209
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-15, 10],
    [-10, 0],
    //		210    		211    		212			213    		214    		215    		216    		217    		218    		219
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    //		220    		221    		222			223    		224    		225    		226    		227    		228    		229
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [0, 0],
    [0, 10],
    [10, -25],
    //		230    		231    		232			233    		234    		235    		236    		237    		238    		239
    [-10, 0],
    [-20, 13],
    [-15, 15],
    [-10, 0],
    [-10, 0],
    [-10, 0],
    [-35, 10],
    [25, -15],
    [-10, 10],
    [-25, 23],
    //		240    		241    		242			243    		244    		245    		246    		247    		248    		249
    [-13, 23],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [-13, 28],
    [0, 0]
  ];

  //
  //		Adv550 Item display array - true means the item tag can be displayed on map.
  //		___________________________________________________________________________________________
  //                              	0      1      2      3      4      5      6      7      8      9
  var itmsDispl = [
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //          						10     11     12     13     14     15     16     17     18     19
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //          						20     21     22     23     24     25     26     27     28     29
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //          						30     31     32     33     34     35     36     37     38     39
    false,
    false,
    false,
    false,
    true,
    true,
    false,
    true,
    true,
    true,
    //          						40     41     42     43     44     45     46     47     48     49
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //          						50     51     52     53     54     55     56     57     58     59
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //          						60     61     62     63     64     65     66     67     68     69
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //          						70     71     72     73     74     75     76     77     78     79
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    false,
    //          						80     81     82     83     84     85     86     87     88     89
    false,
    true,
    true,
    true,
    true,
    true,
    true,
    false,
    false,
    false,
    //	          						90     91     92     93     94     95     96     97     98     99
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                              	100    101    102    103    104    105    106    107    108    109
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //	                              	110    111    112    113    114    115    116    117    118    119
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //	                              	120    121    122    123    124    125    126    127    128    129
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                                  130    131    132    133    134    145    136    137    138    139
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                                  140    141    142    143    144    145    146    147    148    149
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                                  150    151    152    153    154    155    156    157    158    159
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                                  160    161    162    163    164    165    166    167    168    169
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false
  ];
} else if (version == 551) {
  var PINXOFF = 363; // Offset position of pin image (less is right)
  var PINYOFF = 96; //   							(less is down)
  var ITMXOFF = PINXOFF - 5; // Offset position of item image
  var ITMYOFF = PINYOFF - 40;

  //
  //		Adv551 Map Image (x,y) coordinates for a Pin at a given location number.
  //		___________________________________________________________________________________________
  var mapXY = [
    // Loc: 0    		1    		2			3    		4    		5    		6    		7    		8    		9
    [0, 0],
    [1385, 577],
    [1335, 577],
    [1425, 577],
    [1449, 639],
    [1309, 502],
    [1300, 495],
    [1469, 710],
    [1512, 806],
    [1479, 855],
    // 		10    		11    		12			13    		14    		15    		16    		17    		18    		19
    [1404, 855],
    [1353, 855],
    [1293, 859],
    [1234, 857],
    [1171, 854],
    [1068, 891],
    [0, 0],
    [1048, 891],
    [1068, 937],
    [1095, 674],
    //		20    		21    		22			23    		24    		25    		26    		27    		28    		29
    [0, 0],
    [0, 0],
    [0, 0],
    [344, 877],
    [393, 891],
    [345, 891],
    [0, 0],
    [1017, 891],
    [1153, 377],
    [1045, 731],
    //		30    		31    		32			33    		34    		35    		36    		37    		38    		39
    [960, 656],
    [0, 0],
    [0, 0],
    [1147, 280],
    [1237, 280],
    [984, 266],
    [967, 480],
    [1061, 483],
    [1082, 525],
    [900, 480],
    //		40    		41    		42			43    		44    		45    		46    		47    		48    		49
    [0, 0],
    [925, 891],
    [936, 932],
    [921, 940],
    [937, 944],
    [941, 983],
    [957, 940],
    [967, 952],
    [948, 951],
    [954, 963],
    //		50    		51    		52			53    		54    		55    		56    		57    		58    		59
    [928, 972],
    [969, 964],
    [952, 980],
    [919, 960],
    [987, 959],
    [974, 979],
    [992, 982],
    [1023, 989],
    [1006, 969],
    [0, 0],
    //		60    		61    		62			63    		64    		65    		66    		67    		68    		69
    [857, 892],
    [797, 886],
    [875, 651],
    [875, 610],
    [669, 542],
    [529, 656],
    [530, 747],
    [391, 877],
    [395, 732],
    [789, 658],
    //		70    		71    		72			73    		74    		75    		76    		77    		78    		79
    [700, 656],
    [505, 587],
    [245, 585],
    [247, 524],
    [912, 773],
    [705, 851],
    [711, 890],
    [651, 826],
    [0, 0],
    [0, 0],
    //		80    		81    		82			83    		84    		85    		86    		87    		88    		89
    [962, 974],
    [985, 989],
    [990, 988],
    [1023, 970],
    [1034, 972],
    [1044, 976],
    [1047, 980],
    [1040, 989],
    [258, 876],
    [0, 0],
    //		90    		91    		92			93    		94    		95    		96    		97    		98    		99
    [0, 0],
    [133, 625],
    [100, 787],
    [0, 0],
    [138, 739],
    [149, 703],
    [596, 747],
    [382, 621],
    [395, 561],
    [352, 502],
    //		100    		101    		102			103    		104    		105    		106    		107    		108    		109
    [444, 503],
    [487, 454],
    [721, 438],
    [651, 483],
    [581, 506],
    [546, 542],
    [738, 585],
    [729, 991],
    [873, 550],
    [941, 268],
    //		110    		111    		112			113    		114    		115    		116    		117    		118    		119
    [904, 259],
    [720, 749],
    [675, 975],
    [937, 213],
    [995, 989],
    [0, 0],
    [0, 0],
    [150, 455],
    [145, 523],
    [796, 754],
    //		120    		121    		122			123    		124    		125    		126    		127    		128    		129
    [796, 754],
    [796, 754],
    [198, 407],
    [284, 344],
    [387, 328],
    [425, 288],
    [423, 263],
    [478, 289],
    [397, 376],
    [442, 394],
    //		130    		131    		132			133    		134    		135    		136    		137    		138    		139
    [483, 396],
    [694, 969],
    [682, 968],
    [681, 986],
    [641967],
    [641, 985],
    [689, 991],
    [723, 1001],
    [742, 999],
    [709, 981],
    //		140    		141    		142			143    		144    		145    		146    		147    		148    		149
    [714, 976],
    [241, 684],
    [301, 683],
    [1210, 617],
    [1248, 618],
    [1103, 119],
    [1304, 546],
    [1429, 320],
    [1433, 182],
    [1433, 148],
    //		150    		151    		152			153    		154    		155    		156    		157    		158    		159
    [1402, 147],
    [1457, 148],
    [1436, 107],
    [1060, -16],
    [1041, -83],
    [936, -92],
    [1305, 508],
    [1041, -138],
    [1302, -128],
    [1303, -184],
    //		160    		161    		162			163    		164    		165    		166    		167    		168    		169
    [1305, -88],
    [1395, 485],
    [1365, 478],
    [1370, 497],
    [1342, 491],
    [1336, 508],
    [52, 27],
    [1375, -96],
    [185, 34],
    [183, -28],
    //		170    		171    		172			173    		174    		175    		176    		177    		178    		179
    [257, 55],
    [337, 95],
    [879, 951],
    [957, 60],
    [851, 1018],
    [781, 995],
    [957, 38],
    [708, 935],
    [0, 0],
    [258, -22],
    //		180    		181    		182			183    		184    		185    		186    		187    		188    		189
    [418, 98],
    [0, 0],
    [358, 207],
    [484, 199],
    [592, 173],
    [485, 241],
    [589, 235],
    [547, 137],
    [636, 200],
    [0, 0],
    //		190    		191    		192			193    		194    		195    		196    		197    		198    		199
    [593, 357],
    [827, 935],
    [100, 98],
    [251, 115],
    [770, -190],
    [770, -190],
    [728, 431],
    [190, 110],
    [326, -34],
    [0, 0],
    //		200    		201    		202			203    		204    		205    		206    		207    		208    		209
    [380, 25],
    [457, 24],
    [545, 22],
    [404, -32],
    [488, -32],
    [554, -27],
    [692, 25],
    [692, -21],
    [692, -92],
    [635, -98],
    //		210    		211    		212			213    		214    		215    		216    		217    		218    		219
    [685, -157],
    [741, -150],
    [0, 0],
    [689, 100],
    [84, -61],
    [148, -107],
    [232, -85],
    [316, -93],
    [399, 96],
    [517, -89],
    //		220    		221    		222			223    		224    		225    		226    		227    		228    		229
    [553, -88],
    [478, -91],
    [514, -117],
    [558, -188],
    [694, -190],
    [588, -92],
    [0, 0],
    [1114, -144],
    [1189, -133],
    [1238, -133],
    //		230    		231    		232			233    		234    		235    		236    		237    		238    		239
    [421, -151],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [590, 313],
    [0, 0],
    [0, 0],
    [1462, 560],
    [1063, 35],
    //		240    		241    		242			243    		244    		245    		246    		247    		248    		249
    [1030, 95],
    [951, 99],
    [905, 97],
    [885, 111],
    [896, 95],
    [879, 93],
    [878, 73],
    [855, 93],
    [806, 97],
    [0, 0]
  ];

  //
  //		Adv551 Item tag Image (x,y) offsets from Pin coordinates (above). Less is left, up.
  //		Each location's offsets are specified to try to 'neatly' position an item tag at the location.
  //		___________________________________________________________________________________________
  var itmsXY = [
    // Loc: 0    		1    		2			3    		4    		5    		6    		7    		8    		9
    [0, 0],
    [-20, -10],
    [-20, -10],
    [-25, 10],
    [-20, 0],
    [-30, -10],
    [-40, -30],
    [0, 0],
    [0, 20],
    [-20, 20],
    // 		10    		11    		12			13    		14    		15    		16    		17    		18    		19
    [-10, 20],
    [-10, 20],
    [-15, 16],
    [-15, 20],
    [-18, 20],
    [5, -15],
    [0, 0],
    [-10, -5],
    [-5, 10],
    [20, -20],
    //		20    		21    		22			23    		24    		25    		26    		27    		28    		29
    [0, 0],
    [0, 0],
    [0, 0],
    [-32, -45],
    [-25, 30],
    [-40, 30],
    [0, 0],
    [-60, -30],
    [20, -15],
    [-30, 10],
    //		30    		31    		32			33    		34    		35    		36    		37    		38    		39
    [-30, 15],
    [0, 0],
    [0, 0],
    [15, 10],
    [0, 0],
    [0, 10],
    [-10, 15],
    [5, -35],
    [-15, 20],
    [-20, 15],
    //		40    		41    		42			43    		44    		45    		46    		47    		48    		49
    [0, 0],
    [-15, -30],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //		50    		51    		52			53    		54    		55    		56    		57    		58    		59
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    //		60    		61    		62			63    		64    		65    		66    		67    		68    		69
    [-2, 12],
    [5, -20],
    [-25, 15],
    [20, -15],
    [-35, 10],
    [-50, -27],
    [-52, 15],
    [-10, -40],
    [-90, -20],
    [-30, 20],
    //		70    		71    		72			73    		74    		75    		76    		77    		78    		79
    [-50, -10],
    [30, -20],
    [30, -25],
    [-15, -40],
    [-15, 15],
    [-80, -10],
    [-35, 5],
    [-20, 10],
    [0, 0],
    [0, 0],
    //		80    		81    		82			83    		84    		85    		86    		87    		88    		89
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    [0, 0],
    //		90    		91    		92			93    		94    		95    		96    		97    		98    		99
    [0, 0],
    [-25, 15],
    [55, 0],
    [0, 0],
    [5, -12],
    [50, -20],
    [-30, 12],
    [20, -35],
    [0, 10],
    [-25, 5],
    //		100    		101    		102			103    		104    		105    		106    		107    		108    		109
    [-20, 15],
    [25, -25],
    [35, -15],
    [25, -10],
    [-35, -42],
    [-20, 7],
    [-25, 10],
    [-4, -11],
    [40, -10],
    [-25, 0],
    //		110    		111    		112			113    		114    		115    		116    		117    		118    		119
    [-60, 10],
    [-20, 30],
    [-4, -11],
    [0, 0],
    [-5, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [30, -30],
    [-20, 15],
    //		120    		121    		122			123    		124    		125    		126    		127    		128    		129
    [-20, 15],
    [-20, 15],
    [10, -15],
    [-10, 15],
    [25, 10],
    [0, 5],
    [-55, -20],
    [-25, 5],
    [-60, 10],
    [-30, 0],
    //		130    		131    		132			133    		134    		135    		136    		137    		138    		139
    [30, -20],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //		140    		141    		142			143    		144    		145    		146    		147    		148    		149
    [0, 0],
    [-25, 20],
    [0, 0],
    [0, 0],
    [-20, 20],
    [-4, -11],
    [-4, -11],
    [-75, 20],
    [-4, -11],
    [-4, -11],
    //		150    		151    		152			153    		154    		155    		156    		157    		158    		159
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -31],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //		160    		161    		162			163    		164    		165    		166    		167    		168    		169
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-3, 5],
    [0, -31],
    [-18, -25],
    //		170    		171    		172			173    		174    		175    		176    		177    		178    		179
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [20, -11],
    [-4, -11],
    [2, -11],
    [30, -25],
    [0, 0],
    [0, 0],
    //		180    		181    		182			183    		184    		185    		186    		187    		188    		189
    [0, 15],
    [0, 0],
    [0, 0],
    [-20, 12],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //		190    		191    		192			193    		194    		195    		196    		197    		198    		199
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //		200    		201    		202			203    		204    		205    		206    		207    		208    		209
    [-20, 19],
    [0, 0],
    [0, 0],
    [0, 0],
    [-35, 13],
    [25, -15],
    [0, 0],
    [0, 0],
    [0, 0],
    [-10, 20],
    //		210    		211    		212			213    		214    		215    		216    		217    		218    		219
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //		220    		221    		222			223    		224    		225    		226    		227    		228    		229
    [-15, 25],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [-15, 18],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //		230    		231    		232			233    		234    		235    		236    		237    		238    		239
    [-10, -25],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [20, 20],
    [0, 0],
    //		240    		241    		242			243    		244    		245    		246    		247    		248    		249
    [0, 0],
    [-13, 23],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [-13, 28],
    [0, 0]
  ];

  //
  //		Adv551 Item display array - true means the item tag can be displayed on map.
  //		___________________________________________________________________________________________
  //                              	0      1      2      3      4      5      6      7      8      9
  var itmsDispl = [
    false,
    true,
    true,
    false,
    true,
    true,
    true,
    false,
    true,
    false,
    //          						10     11     12     13     14     15     16     17     18     19
    true,
    false,
    false,
    false,
    true,
    true,
    true,
    false,
    false,
    true,
    //          						20     21     22     23     24     25     26     27     28     29
    true,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    //          						30     31     32     33     34     35     36     37     38     39
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    false,
    false,
    true,
    //          						40     41     42     43     44     45     46     47     48     49
    true,
    false,
    false,
    false,
    false,
    false,
    true,
    true,
    false,
    true,
    //          						50     51     52     53     54     55     56     57     58     59
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //          						60     61     62     63     64     65     66     67     68     69
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //          						70     71     72     73     74     75     76     77     78     79
    true,
    true,
    true,
    true,
    true,
    true,
    false,
    false,
    false,
    false,
    //          						80     81     82     83     84     85     86     87     88     89
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //	          						90     91     92     93     94     95     96     97     98     99
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                              	100    101    102    103    104    105    106    107    108    109
    false,
    true,
    true,
    false,
    false,
    false,
    true,
    false,
    true,
    false,
    //	                              	110    111    112    113    114    115    116    117    118    119
    false,
    false,
    false,
    true,
    true,
    false,
    false,
    false,
    true,
    true,
    //	                              	120    121    122    123    124    125    126    127    128    129
    true,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                                  130    131    132    133    134    145    136    137    138    139
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                                  140    141    142    143    144    145    146    147    148    149
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                                  150    151    152    153    154    155    156    157    158    159
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                                  160    161    162    163    164    165    166    167    168    169
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false
  ];
} else if ((version == 570) | (version == 751)) {
  var PINXOFF = 355; // Offset position of pin image
  var PINYOFF = 387;
  var ITMXOFF = 350; // Offset position of item image
  var ITMYOFF = 352;
  //
  //    Adv570 Map Image (x,y) coordinates for a Pin at a given location number.
  //    ___________________________________________________________________________________________
  var mapXY = [
    // Loc: 0       1           2           3            4          5           6           7           8           9
    [0, 0],
    [1385, 577],
    [1304, 571],
    [1425, 577],
    [1449, 639],
    [1304, 512],
    [1316, 476],
    [1469, 710],
    [1512, 806],
    [1479, 855],
    //    10        	11        	12      		13        14        15        16        	17        18        19
    [1404, 855],
    [1353, 855],
    [1293, 859],
    [1234, 857],
    [1171, 854],
    [1068, 891],
    [0, 0],
    [1048, 891],
    [1068, 937],
    [1095, 674],
    //    20        21        22      	23        24        	25        26        27        	28        29
    [0, 0],
    [0, 0],
    [0, 0],
    [344, 877],
    [393, 891],
    [345, 891],
    [0, 0],
    [1017, 891],
    [1153, 377],
    [1045, 731],
    //    30        	31        32      	33        	34        	35        	36        	37        	38        39
    [960, 656],
    [0, 0],
    [0, 0],
    [1147, 280],
    [1237, 280],
    [984, 266],
    [967, 480],
    [1061, 483],
    [1082, 525],
    [900, 480],
    //    40        41        	42      	43        44        	45        46        	47        48        49
    [0, 0],
    [925, 891],
    [936, 932],
    [921, 940],
    [937, 944],
    [941, 983],
    [957, 940],
    [967, 952],
    [948, 951],
    [954, 963],
    //    50        51        	52      	53        	54        	55        	56        57        58        59
    [928, 972],
    [969, 964],
    [952, 980],
    [919, 960],
    [987, 959],
    [974, 979],
    [992, 982],
    [1023, 989],
    [1006, 969],
    [0, 0],
    //    60        61        	62      	63        	64        	65        	66        	67        68        69
    [857, 892],
    [797, 886],
    [878, 639],
    [883, 596],
    [669, 542],
    [529, 656],
    [530, 747],
    [391, 877],
    [395, 732],
    [789, 658],
    //    70           71          72          73          74          75          76          77        78        79
    [700, 656],
    [505, 587],
    [245, 585],
    [242, 544],
    [912, 773],
    [705, 883],
    [715, 918],
    [651, 826],
    [0, 0],
    [0, 0],
    //    80        81        82      83        84        85        86        87        88        89
    [962, 974],
    [985, 989],
    [990, 988],
    [1023, 970],
    [1034, 972],
    [1044, 976],
    [1047, 980],
    [1040, 989],
    [258, 876],
    [0, 0],
    //    90        91        	92      93        	94        	95        	96       	 97        	98        99
    [0, 0],
    [133, 625],
    [100, 787],
    [497, 801],
    [138, 739],
    [149, 703],
    [596, 747],
    [382, 621],
    [395, 561],
    [352, 502],
    //    100       101       102     103       104       105       106       107       108       109
    [444, 503],
    [487, 454],
    [721, 438],
    [651, 483],
    [581, 506],
    [546, 542],
    [738, 585],
    [791, 936],
    [873, 550],
    [941, 268],
    //    110       111       	112     	113       	114       115       116      	 117       118       	119
    [904, 259],
    [720, 749],
    [806, 941],
    [941, 213],
    [995, 989],
    [0, 0],
    [0, 0],
    [150, 455],
    [145, 523],
    [796, 754],
    //    120       121       	122     	123       	124       	125       	126       	127       	128       129
    [796, 754],
    [796, 754],
    [198, 407],
    [284, 344],
    [387, 328],
    [425, 288],
    [423, 263],
    [478, 289],
    [397, 376],
    [442, 394],
    //    130       131       132     133       134       135       136       137       138       139
    [483, 396],
    [777, 945],
    [788, 961],
    [808, 941],
    [813, 956],
    [844, 948],
    [870, 953],
    [882, 970],
    [864, 967],
    [860, 979],
    //    140       141            142          143       144         145          146         147         148       		149
    [819, 974],
    [1454, 567],
    [1454, 677],
    [949, 149],
    [1015, 117],
    [1106, 117],
    [1197, 117],
    [1295, 156],
    [532, 861],
    [179, 771],
    //    150       151       	152     	153       	154      155       	156       157       	158       159
    [246, 771],
    [212, 823],
    [298, 771],
    [839, 108],
    [760, 98],
    [685, 100],
    [687, 175],
    [687, 219],
    [964, 596],
    [572, 187],
    //    160       	161       	162     	163       	164       	165       	166       	167       	168       169
    [510, 139],
    [510, 103],
    [1365, 478],
    [1383, 468],
    [1384, 503],
    [1473, 448],
    [1472, 477],
    [802, 425],
    [802, 395],
    [937, 165],
    //    170       	171       172     	173       174       175       176       177       	178       179
    [957, 139],
    [957, 110],
    [957, 84],
    [957, 60],
    [957, 38],
    [957, 38],
    [957, 38],
    [1041, 36],
    [0, 0],
    [0, 0],
    //    180       181       182     183       184       185       186       187       188       189
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //    190       191       192     193       194       195       196       197       198       199
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0]
  ];

  //
  //    Adv570 Item tag Image (x,y) offsets relative to Pin coordinates (above).
  //    Each location's offsets are specified to try to 'neatly' position an item tag at the location.
  //    ___________________________________________________________________________________________
  var itmsXY = [
    // Loc: 0       1       	2     		3       	4       	5       	6       7       	8       	9
    [0, 0],
    [-20, -10],
    [-20, -10],
    [-25, 10],
    [-20, 0],
    [-30, -10],
    [-40, -30],
    [0, 0],
    [0, 20],
    [-20, 20],
    //    10        11        12      	13        14        15      16        17        18        19
    [-10, 20],
    [-10, 20],
    [-15, 16],
    [-15, 20],
    [-18, 20],
    [5, -15],
    [0, 0],
    [-10, -5],
    [-5, 10],
    [20, -20],
    //    20        21        22      	23        24        25        26        27        	28        29
    [0, 0],
    [0, 0],
    [0, 0],
    [-32, -45],
    [-25, 30],
    [-20, 35],
    [0, 0],
    [-60, -30],
    [25, -15],
    [-30, 10],
    //    30        31        32      33        34        35        36        37        38        39
    [-30, 15],
    [0, 0],
    [0, 0],
    [15, 10],
    [0, 0],
    [0, 10],
    [-10, 15],
    [5, -35],
    [-15, 20],
    [-20, 15],
    //    40        41        42      	43        44        45        46        47        48        49
    [0, 0],
    [-15, -30],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //    50        51        52      	53        54        55        56        57        58        59
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    //    60        61        62      	63        64        65        	66        67        	68        69
    [-2, 12],
    [5, -20],
    [-25, 15],
    [-78, 0],
    [-35, 10],
    [-50, -27],
    [-52, 15],
    [-10, -40],
    [-90, -20],
    [-30, 20],
    //    70        71        72      	73        	74        75        	76        77        78        79
    [-50, -10],
    [30, -20],
    [30, -25],
    [-15, -40],
    [-15, 15],
    [-80, -10],
    [-35, 23],
    [-20, 10],
    [0, 0],
    [0, 0],
    //    80        81        82      83        84        85        86        87        88        89
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [0, 0],
    [0, 0],
    //    90        91        92      	93        94        95        96        97        98        99
    [0, 0],
    [-25, 15],
    [-40, 10],
    [0, 0],
    [5, -12],
    [50, -20],
    [-30, 12],
    [20, -35],
    [0, 10],
    [-25, 5],
    //    100       101       102     	103       104       	105       106       107       108       109
    [-20, 15],
    [30, -20],
    [35, -15],
    [25, -10],
    [-35, -42],
    [-20, 7],
    [-25, 10],
    [-4, -11],
    [50, -20],
    [-25, 0],
    //    110       111       112     113       114       115       116       117       118       119
    [-60, 10],
    [-20, 30],
    [-4, -11],
    [0, -10],
    [-5, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [30, -30],
    [-20, 15],
    //    120       121       122     123       124       125       126       127       128       129
    [-20, 15],
    [-20, 15],
    [10, -15],
    [-10, 15],
    [25, 10],
    [0, 5],
    [-55, -20],
    [50, -15],
    [-60, 10],
    [-30, 0],
    //    130       131       132     133       134       135       136       137       138       139
    [30, -20],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    //    140       141       142     	   143       144       145       146       147       148       149
    [0, 0],
    [0, 0],
    [-25, 10],
    [-60, 15],
    [-4, -6],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [15, 0],
    [-4, -28],
    //    150       151       152     	153       154       155       156       157       158       159
    [-4, -11],
    [18, -11],
    [20, -11],
    [-27, 20],
    [-30, 30],
    [-75, -30],
    [25, -11],
    [-20, 25],
    [25, -11],
    [-30, 35],
    //    160       161       162     	163       164       165       166       167       168       169
    [-40, 30],
    [30, -10],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-3, 5],
    [0, -11],
    [-4, -11],
    //    170       171       172     	173       174       175       176       177       178       179
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [-4, -11],
    [2, -11],
    [30, -25],
    [0, 0],
    [0, 0],
    //    180       181       182     	183       184       185       186       187       188       189
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    //    190       191       192     	193       194       195       196       197       198       199
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0],
    [0, 0]
  ];

  //
  //    Adv570 Item display array - true means the item tag can be displayed on map.
  //    ___________________________________________________________________________________________
  //                      0      1      2      3      4      5      6      7      8      9
  var itmsDispl = [
    false,
    true,
    true,
    false,
    true,
    true,
    true,
    false,
    true,
    false,
    //                      10     11     12     13     14     15     16     17     18     19
    true,
    false,
    false,
    false,
    true,
    true,
    true,
    false,
    false,
    true,
    //                      20     21     22     23     24     25     26     27     28     29
    true,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    //                      30     31     32     33     34     35     36     37     38     39
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    false,
    false,
    true,
    //                      40     41     42     43     44     45     46     47     48     49
    false,
    false,
    true,
    true,
    false,
    false,
    false,
    false,
    false,
    true,
    //                      50     51     52     53     54     55     56     57     58     59
    false,
    false,
    false,
    false,
    false,
    false,
    true,
    false,
    false,
    false,
    //                      60     61     62     63     64     65     66     67     68     69
    false,
    false,
    false,
    true,
    true,
    false,
    false,
    false,
    false,
    false,
    //                      70     71     72     73     74     75     76     77     78     79
    true,
    false,
    true,
    false,
    true,
    false,
    false,
    false,
    false,
    false,
    //                      80     81     82     83     84     85     86     87     88     89
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                      90     91     92     93     94     95     96     97     98     99
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                      100     101   102    103   104    105    106    107    108    109
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                      110     111   112    113   114    115    116    117    118    119
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                      120     121   122    123   124    125    126    127    128    129
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                      130     131   132    133   134    135    136    137    138    139
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                      140     141   142    143   144    145    146    147    148    149
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    //                      150     151   152    153   154    155    156    157    158    159
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //                      160     161   162    163   164    165    166    167    168    169
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //                      170     171   172    173   174    175    176    177    178    179
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //                      180     181   182    183   184    185    186    187    188    189
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    //                      190     191   192    193   194    195    196    197    198    199
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true,
    true
  ];
}

function toggleMap() {
  showmap = !showmap;

  if (showmap) showMapImages(loc, showPirate, dloc[6], prop[CHEST]);
  else context.clearRect(0, 0, 1200, 800);

  saveShowMap();
}

function showMapImages(sloc, sShowPirate, sPirateLoc, sChestLoc) {
  if (!showmap) return;

  if (mapXY[sloc][0] == 0) return;

  showPirate = sShowPirate;
  pirateLoc = sPirateLoc;
  chestLoc = sChestLoc;

  repositionView(sloc);

  drawMap();

  drawAllItems();

  drawPin(sloc);

  if (showPirate) {
    //   	if (chestLoc != 0){
    drawPiratePin(pirateLoc);

    drawDwarfPins();
  }

  pinLoc = sloc;
  ppinLoc = pirateLoc;

  mapImagesChanged = false;
}

function mouseDown(event) {
  if (event.preventDefault) {
    event.preventDefault();
  } else {
    event.returnValue = false;
  }

  document.body.style.cursor = "move";
  dragging = true;
  mouseXY(event);
  lastX = canX;
  lastY = canY;

  //sayIt("click ("+(canX+PINXOFF-5)+","+(canY+PINYOFF-47)+")");
}

function mouseUp() {
  document.body.style.cursor = "pointer";
  dragging = false;

  //console.log("clicky "+(canX+PINXOFF+dragOffX-3)+","+(canY+PINYOFF+dragOffY-46));
}

function mouseMove(e) {
  e.preventDefault();

  if (dragging) {
    dragMap(e);
  }
}

function dragMap(e) {
  mouseXY(e);

  newDragOffX = dragOffX + (lastX - canX);
  newDragOffY = dragOffY + (lastY - canY);

  if ((mapX - newDragOffX < rightMaxX) & (mapX - newDragOffX > leftMaxX)) {
    dragOffX = newDragOffX;
  }

  if ((mapY - newDragOffY < topMaxY) & (mapY - newDragOffY > botMaxY)) {
    dragOffY = newDragOffY;
  }

  drawMap();
  drawAllItems();
  drawPin(pinLoc);

  if (showPirate) {
    //   	if (chestLoc != 0){
    drawPiratePin(pirateLoc);

    drawDwarfPins();
  }

  lastX = canX;
  lastY = canY;
}

function mouseXY(e) {
  if (!e) var e = event;

  if (IE) {
    // grab the x-y pos.s if browser is IE
    tempX = event.clientX + document.body.scrollLeft;
    tempY = event.clientY + document.body.scrollTop;
  } else {
    // grab the x-y pos.s if browser is NS
    tempX = e.pageX;
    tempY = e.pageY;
  }

  //sayIt((tempX + dragOffX - 245)+","+(tempY + dragOffY - 34));

  canX = tempX - canvas.offsetLeft;
  canY = tempY - canvas.offsetTop;
}

function mouseOver(e) {
  if (!dragging) document.body.style.cursor = "pointer";
}
function mouseOut(e) {
  if (!dragging) document.body.style.cursor = "default";
}

function drawMap() {
  if (!showmap) return;

  context.drawImage(imageObj1, mapX - dragOffX, mapY - dragOffY);
  //console.log("Drawmap "+(mapX - dragOffX)+" , "+(mapY - dragOffY));
}

/*_______________________________________________________________________________________________
 * 					drawAllItems
 *    Draws all Item tags present at every map location.
 */

function drawAllItems() {
  if (!showmap) return;

  if (version == 550) {
    // 550 version

    drawAllItems550();
    return;
  }

  var row, col, obj, itm, itmx, itmy;

  for (var nloc = 1; nloc <= LOCSIZ; nloc++) {
    // run thru each location nloc

    if ((version == 570) | (version == 751)) {
      itm = atlocFirst[nloc];
    } else {
      itm = atloc[nloc];
    }
    obj = itm;

    row = 0;
    col = 0;

    while (obj != 0) {
      // run thru each item at a location nloc

      if ((version == 570) | (version == 751)) {
        if (itm > 200) obj = itm - 200;
        else obj = itm;
      } else if ((version != 501) & (version != 551)) {
        if (itm > 100) obj = itm - 100;
        else obj = itm;
      } else obj = itm;

      //console.log("... Loc "+nloc+" Item "+itm)
      if (itmsDispl[obj]) {
        // displayable item

        if (mapXY[nloc][0] > 0) {
          // Only display items at on-map locations

          row++;

          itmx = itmsXY[nloc][0];
          itmy = itmsXY[nloc][1];

          if ((version == 570) | (version == 751))
            if (obj == DUCKY && prop[DUCKY] <= 0)
              // Show the duck out in the middle of the reservoir
              itmy = itmy - 30;

          //if (nloc == 158)
          //  console.log("### Loc "+nloc+" Item "+itm+" at "+itmSrcPosX[itm]+","+itmSrcPosY[itm]+" to "+
          //            (mapXY[nloc][0]+itmx+col*80)+","+(mapXY[nloc][1]+itmy+(row-1)*15)+" display "+itmsDispl[itm]);

          // Draw item tag on map
          context.drawImage(
            imageObj4,
            itmSrcPosX[obj], // item x pos in source image file
            itmSrcPosY[obj], // item y pos in source image file
            itmSrcWd,
            itmSrcHt,
            mapXY[nloc][0] + itmx + col * 80 - ITMXOFF - dragOffX, // x pos in target map
            mapXY[nloc][1] + itmy + (row - 1) * 15 - ITMYOFF - dragOffY, // y pos in target map
            itmSrcWd,
            itmSrcHt
          );

          if (row % 10 == 0) {
            // Stack items in multiple columns if many are present at same location.
            row = 0;
            col++;
          }
        }
      }
      if ((version == 570) | (version == 751)) itm = linkFwd[itm];
      else itm = link[itm];
    }
  }
}

/*_______________________________________________________________________________________________
 * 					drawAllItems550
 *    Draws all Item tags present at every map location.
 */

function drawAllItems550() {
  var row, col, plc;

  for (var ii = 0; ii <= PLACES; ii++) {
    // run thru each location ii

    plc = ii + 2000;
    row = 0;
    col = 0;

    if (plc == 2241)
      // Limbo
      continue;

    for (var jj = 0; jj <= OBJECTS; jj++) {
      // Look for all objects in the location

      if (objLoc[jj] == plc) {
        if (itmsDispl[jj]) {
          if (mapXY[ii][0] > 0) {
            // Only display items at on-map locations

            row++;

            // Draw item tag on map
            context.drawImage(
              imageObj4,
              itmSrcPosX[jj],
              itmSrcPosY[jj],
              itmSrcWd,
              itmSrcHt,
              mapXY[ii][0] + itmsXY[ii][0] + col * 80 - ITMXOFF - dragOffX,
              mapXY[ii][1] +
                itmsXY[ii][1] +
                (row - 1) * 15 -
                ITMYOFF -
                dragOffY,
              itmSrcWd,
              itmSrcHt
            );

            if (row % 10 == 0) {
              // Stack items in multiple columns if many are present at same location.
              row = 0;
              col++;
            }
          }
        }
      }
    }
  }
}

function drawPin(ploc) {
  if (!showmap) return;

  pinX = mapXY[ploc][0] - PINXOFF;
  pinY = mapXY[ploc][1] - PINYOFF;

  context.drawImage(
    imageObj2,
    0,
    0,
    51,
    64,
    pinX - dragOffX,
    pinY - dragOffY,
    51,
    64
  );
  context.drawImage(
    imageObj3,
    0,
    0,
    51,
    64,
    pinX - dragOffX,
    pinY - dragOffY,
    51,
    64
  );

  //sayIt("pin  ("+(mapXY[ploc][0])+","+(mapXY[ploc][1])+")");
}

function drawPiratePin(ploc) {
  if (!showmap) return;

  ppinX = mapXY[ploc][0] - PINXOFF - 5;
  ppinY = mapXY[ploc][1] - PINYOFF - 5;

  context.drawImage(
    imageObj5,
    0,
    0,
    51,
    64,
    ppinX - dragOffX,
    ppinY - dragOffY,
    51,
    64
  );
  context.drawImage(
    imageObj3,
    0,
    0,
    51,
    64,
    ppinX - dragOffX,
    ppinY - dragOffY,
    51,
    64
  );
}

function drawDwarfPins() {
  if (!showmap) return;

  for (var dw = 1; dw <= 5; dw++)
    if (dloc[dw] > 0) {
      dpinX = mapXY[dloc[dw]][0] - PINXOFF + 2 * dw;
      dpinY = mapXY[dloc[dw]][1] - PINYOFF + 5;

      context.drawImage(
        imageObj6,
        0,
        0,
        51,
        64,
        dpinX - dragOffX,
        dpinY - dragOffY,
        51,
        64
      );
      context.drawImage(
        imageObj3,
        0,
        0,
        51,
        64,
        dpinX - dragOffX,
        dpinY - dragOffY,
        51,
        64
      );
    }
}

/*_______________________________________________________________________________________________
 * 					repositionView
 *    If Location Pin moves off-screen, reposition the viewed map image so the Pin is always visible.
 */

function repositionView(ploc) {
  var pinMapX = mapXY[ploc][0] - PINXOFF - dragOffX;
  var pinMapY = mapXY[ploc][1] - PINYOFF - dragOffY;

  if (
    pinMapX > 20 &&
    pinMapX < viewWidth - 20 &&
    pinMapY > 40 &&
    pinMapY < viewHeight - 40
  )
    return;

  if (pinMapX <= 40) dragOffX = dragOffX + pinMapX;
  // Left edge
  else if (pinMapX >= viewWidth - 20)
    dragOffX = dragOffX + (pinMapX - (viewWidth - 80)); // Right edge

  if (pinMapY <= 40) dragOffY = dragOffY + pinMapY;
  // Top edge
  else if (pinMapY >= viewHeight - 40)
    dragOffY = dragOffY + (pinMapY - (viewHeight - 80)); // Bottom edge
}
